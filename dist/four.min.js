/*! Four v0.3.0 | Jason Petersen (@allotrop3) | MIT Licensed */
!function(t){function e(r){if(n[r])return n[r].exports;var i=n[r]={exports:{},id:r,loaded:!1};return t[r].call(i.exports,i,i.exports,e),i.loaded=!0,i.exports}var n={};return e.m=t,e.c=n,e.p="",e(0)}([function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var i=n(1),o=r(i),a=n(11),u=r(a),c=n(12),s=r(c),f=n(14),l=r(f),h=n(13),p=r(h),d=n(18),v=r(d),y=n(19),b=r(y),g=n(20),m=r(g),_=n(21),w=r(_),O=n(22),M=r(O),E=n(23),k=r(E),P=n(24),j=r(P),T=n(25),R=r(T),A=n(26),x=r(A),S=n(27),F=r(S),D=n(29),C=r(D),L=n(32),N=r(L),U=n(33),Y=r(U),I=n(45),q=r(I),V=n(46),B=r(V),z=n(35),X=r(z),H=n(44),G=r(H),W=n(34),Z=r(W),Q=n(47),K=r(Q),J=n(16),$=r(J),tt=n(49),et=r(tt),nt=n(48),rt=r(nt),it=n(50),ot=r(it),at=n(51),ut=r(at),ct=n(17),st=r(ct),ft=n(28),lt=r(ft),ht=n(53),pt=r(ht),dt=n(54),vt=r(dt),yt=n(55),bt=r(yt),gt=n(56),mt=r(gt),_t=n(57),wt=r(_t),Ot=window.Four={glm:o["default"],Entity:u["default"],Attribute:s["default"],Camera:l["default"],Context:p["default"],OrthographicCamera:v["default"],PerspectiveCamera:b["default"],Framebuffer:m["default"],DeferredFramebuffer:w["default"],DepthFramebuffer:M["default"],Light:k["default"],PointLight:j["default"],Material:R["default"],PhongMaterial:x["default"],Mesh:F["default"],MeshLoader:C["default"],OBJMeshLoader:N["default"],Program:Y["default"],Renderbuffer:q["default"],Scene:B["default"],Shader:X["default"],FragmentShader:G["default"],VertexShader:Z["default"],ShadowMapper:K["default"],Structure:$["default"],Texture:et["default"],DataTexture:rt["default"],DepthTexture:ot["default"],ImageTexture:ut["default"],Uniform:st["default"],VertexArrayObject:lt["default"],Particle:pt["default"],ParticleSystem:vt["default"],Spring:bt["default"],Cloth:mt["default"],Bundle:wt["default"]};e["default"]=Ot},function(t,e,n){"use strict";e.glMatrix=n(2),e.mat2=n(3),e.mat2d=n(4),e.mat3=n(5),e.mat4=n(6),e.quat=n(7),e.vec2=n(10),e.vec3=n(8),e.vec4=n(9)},function(t,e){"use strict";var n={};n.EPSILON=1e-6,n.ARRAY_TYPE="undefined"!=typeof Float32Array?Float32Array:Array,n.RANDOM=Math.random,n.setMatrixArrayType=function(t){GLMAT_ARRAY_TYPE=t};var r=Math.PI/180;n.toRadian=function(t){return t*r},t.exports=n},function(t,e,n){"use strict";var r=n(2),i={};i.create=function(){var t=new r.ARRAY_TYPE(4);return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t},i.clone=function(t){var e=new r.ARRAY_TYPE(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},i.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},i.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t},i.transpose=function(t,e){if(t===e){var n=e[1];t[1]=e[2],t[2]=n}else t[0]=e[0],t[1]=e[2],t[2]=e[1],t[3]=e[3];return t},i.invert=function(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],a=n*o-i*r;return a?(a=1/a,t[0]=o*a,t[1]=-r*a,t[2]=-i*a,t[3]=n*a,t):null},i.adjoint=function(t,e){var n=e[0];return t[0]=e[3],t[1]=-e[1],t[2]=-e[2],t[3]=n,t},i.determinant=function(t){return t[0]*t[3]-t[2]*t[1]},i.multiply=function(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3],u=n[0],c=n[1],s=n[2],f=n[3];return t[0]=r*u+o*c,t[1]=i*u+a*c,t[2]=r*s+o*f,t[3]=i*s+a*f,t},i.mul=i.multiply,i.rotate=function(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3],u=Math.sin(n),c=Math.cos(n);return t[0]=r*c+o*u,t[1]=i*c+a*u,t[2]=r*-u+o*c,t[3]=i*-u+a*c,t},i.scale=function(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3],u=n[0],c=n[1];return t[0]=r*u,t[1]=i*u,t[2]=o*c,t[3]=a*c,t},i.fromRotation=function(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=n,t[2]=-n,t[3]=r,t},i.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=e[1],t},i.str=function(t){return"mat2("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},i.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2))},i.LDU=function(t,e,n,r){return t[2]=r[2]/r[0],n[0]=r[0],n[1]=r[1],n[3]=r[3]-t[2]*n[1],[t,e,n]},t.exports=i},function(t,e,n){"use strict";var r=n(2),i={};i.create=function(){var t=new r.ARRAY_TYPE(6);return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t},i.clone=function(t){var e=new r.ARRAY_TYPE(6);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e},i.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t},i.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t},i.invert=function(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],a=e[4],u=e[5],c=n*o-r*i;return c?(c=1/c,t[0]=o*c,t[1]=-r*c,t[2]=-i*c,t[3]=n*c,t[4]=(i*u-o*a)*c,t[5]=(r*a-n*u)*c,t):null},i.determinant=function(t){return t[0]*t[3]-t[1]*t[2]},i.multiply=function(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3],u=e[4],c=e[5],s=n[0],f=n[1],l=n[2],h=n[3],p=n[4],d=n[5];return t[0]=r*s+o*f,t[1]=i*s+a*f,t[2]=r*l+o*h,t[3]=i*l+a*h,t[4]=r*p+o*d+u,t[5]=i*p+a*d+c,t},i.mul=i.multiply,i.rotate=function(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3],u=e[4],c=e[5],s=Math.sin(n),f=Math.cos(n);return t[0]=r*f+o*s,t[1]=i*f+a*s,t[2]=r*-s+o*f,t[3]=i*-s+a*f,t[4]=u,t[5]=c,t},i.scale=function(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3],u=e[4],c=e[5],s=n[0],f=n[1];return t[0]=r*s,t[1]=i*s,t[2]=o*f,t[3]=a*f,t[4]=u,t[5]=c,t},i.translate=function(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3],u=e[4],c=e[5],s=n[0],f=n[1];return t[0]=r,t[1]=i,t[2]=o,t[3]=a,t[4]=r*s+o*f+u,t[5]=i*s+a*f+c,t},i.fromRotation=function(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=n,t[2]=-n,t[3]=r,t[4]=0,t[5]=0,t},i.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=e[1],t[4]=0,t[5]=0,t},i.fromTranslation=function(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=e[0],t[5]=e[1],t},i.str=function(t){return"mat2d("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+")"},i.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+1)},t.exports=i},function(t,e,n){"use strict";var r=n(2),i={};i.create=function(){var t=new r.ARRAY_TYPE(9);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},i.fromMat4=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t},i.clone=function(t){var e=new r.ARRAY_TYPE(9);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e},i.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t},i.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},i.transpose=function(t,e){if(t===e){var n=e[1],r=e[2],i=e[5];t[1]=e[3],t[2]=e[6],t[3]=n,t[5]=e[7],t[6]=r,t[7]=i}else t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8];return t},i.invert=function(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],a=e[4],u=e[5],c=e[6],s=e[7],f=e[8],l=f*a-u*s,h=-f*o+u*c,p=s*o-a*c,d=n*l+r*h+i*p;return d?(d=1/d,t[0]=l*d,t[1]=(-f*r+i*s)*d,t[2]=(u*r-i*a)*d,t[3]=h*d,t[4]=(f*n-i*c)*d,t[5]=(-u*n+i*o)*d,t[6]=p*d,t[7]=(-s*n+r*c)*d,t[8]=(a*n-r*o)*d,t):null},i.adjoint=function(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],a=e[4],u=e[5],c=e[6],s=e[7],f=e[8];return t[0]=a*f-u*s,t[1]=i*s-r*f,t[2]=r*u-i*a,t[3]=u*c-o*f,t[4]=n*f-i*c,t[5]=i*o-n*u,t[6]=o*s-a*c,t[7]=r*c-n*s,t[8]=n*a-r*o,t},i.determinant=function(t){var e=t[0],n=t[1],r=t[2],i=t[3],o=t[4],a=t[5],u=t[6],c=t[7],s=t[8];return e*(s*o-a*c)+n*(-s*i+a*u)+r*(c*i-o*u)},i.multiply=function(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3],u=e[4],c=e[5],s=e[6],f=e[7],l=e[8],h=n[0],p=n[1],d=n[2],v=n[3],y=n[4],b=n[5],g=n[6],m=n[7],_=n[8];return t[0]=h*r+p*a+d*s,t[1]=h*i+p*u+d*f,t[2]=h*o+p*c+d*l,t[3]=v*r+y*a+b*s,t[4]=v*i+y*u+b*f,t[5]=v*o+y*c+b*l,t[6]=g*r+m*a+_*s,t[7]=g*i+m*u+_*f,t[8]=g*o+m*c+_*l,t},i.mul=i.multiply,i.translate=function(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3],u=e[4],c=e[5],s=e[6],f=e[7],l=e[8],h=n[0],p=n[1];return t[0]=r,t[1]=i,t[2]=o,t[3]=a,t[4]=u,t[5]=c,t[6]=h*r+p*a+s,t[7]=h*i+p*u+f,t[8]=h*o+p*c+l,t},i.rotate=function(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3],u=e[4],c=e[5],s=e[6],f=e[7],l=e[8],h=Math.sin(n),p=Math.cos(n);return t[0]=p*r+h*a,t[1]=p*i+h*u,t[2]=p*o+h*c,t[3]=p*a-h*r,t[4]=p*u-h*i,t[5]=p*c-h*o,t[6]=s,t[7]=f,t[8]=l,t},i.scale=function(t,e,n){var r=n[0],i=n[1];return t[0]=r*e[0],t[1]=r*e[1],t[2]=r*e[2],t[3]=i*e[3],t[4]=i*e[4],t[5]=i*e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t},i.fromTranslation=function(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=e[0],t[7]=e[1],t[8]=1,t},i.fromRotation=function(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=n,t[2]=0,t[3]=-n,t[4]=r,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},i.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=e[1],t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},i.fromMat2d=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=0,t[3]=e[2],t[4]=e[3],t[5]=0,t[6]=e[4],t[7]=e[5],t[8]=1,t},i.fromQuat=function(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],a=n+n,u=r+r,c=i+i,s=n*a,f=r*a,l=r*u,h=i*a,p=i*u,d=i*c,v=o*a,y=o*u,b=o*c;return t[0]=1-l-d,t[3]=f-b,t[6]=h+y,t[1]=f+b,t[4]=1-s-d,t[7]=p-v,t[2]=h-y,t[5]=p+v,t[8]=1-s-l,t},i.normalFromMat4=function(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],a=e[4],u=e[5],c=e[6],s=e[7],f=e[8],l=e[9],h=e[10],p=e[11],d=e[12],v=e[13],y=e[14],b=e[15],g=n*u-r*a,m=n*c-i*a,_=n*s-o*a,w=r*c-i*u,O=r*s-o*u,M=i*s-o*c,E=f*v-l*d,k=f*y-h*d,P=f*b-p*d,j=l*y-h*v,T=l*b-p*v,R=h*b-p*y,A=g*R-m*T+_*j+w*P-O*k+M*E;return A?(A=1/A,t[0]=(u*R-c*T+s*j)*A,t[1]=(c*P-a*R-s*k)*A,t[2]=(a*T-u*P+s*E)*A,t[3]=(i*T-r*R-o*j)*A,t[4]=(n*R-i*P+o*k)*A,t[5]=(r*P-n*T-o*E)*A,t[6]=(v*M-y*O+b*w)*A,t[7]=(y*_-d*M-b*m)*A,t[8]=(d*O-v*_+b*g)*A,t):null},i.str=function(t){return"mat3("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+")"},i.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+Math.pow(t[6],2)+Math.pow(t[7],2)+Math.pow(t[8],2))},t.exports=i},function(t,e,n){"use strict";var r=n(2),i={};i.create=function(){var t=new r.ARRAY_TYPE(16);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},i.clone=function(t){var e=new r.ARRAY_TYPE(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},i.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},i.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},i.transpose=function(t,e){if(t===e){var n=e[1],r=e[2],i=e[3],o=e[6],a=e[7],u=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=n,t[6]=e[9],t[7]=e[13],t[8]=r,t[9]=o,t[11]=e[14],t[12]=i,t[13]=a,t[14]=u}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t},i.invert=function(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],a=e[4],u=e[5],c=e[6],s=e[7],f=e[8],l=e[9],h=e[10],p=e[11],d=e[12],v=e[13],y=e[14],b=e[15],g=n*u-r*a,m=n*c-i*a,_=n*s-o*a,w=r*c-i*u,O=r*s-o*u,M=i*s-o*c,E=f*v-l*d,k=f*y-h*d,P=f*b-p*d,j=l*y-h*v,T=l*b-p*v,R=h*b-p*y,A=g*R-m*T+_*j+w*P-O*k+M*E;return A?(A=1/A,t[0]=(u*R-c*T+s*j)*A,t[1]=(i*T-r*R-o*j)*A,t[2]=(v*M-y*O+b*w)*A,t[3]=(h*O-l*M-p*w)*A,t[4]=(c*P-a*R-s*k)*A,t[5]=(n*R-i*P+o*k)*A,t[6]=(y*_-d*M-b*m)*A,t[7]=(f*M-h*_+p*m)*A,t[8]=(a*T-u*P+s*E)*A,t[9]=(r*P-n*T-o*E)*A,t[10]=(d*O-v*_+b*g)*A,t[11]=(l*_-f*O-p*g)*A,t[12]=(u*k-a*j-c*E)*A,t[13]=(n*j-r*k+i*E)*A,t[14]=(v*m-d*w-y*g)*A,t[15]=(f*w-l*m+h*g)*A,t):null},i.adjoint=function(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],a=e[4],u=e[5],c=e[6],s=e[7],f=e[8],l=e[9],h=e[10],p=e[11],d=e[12],v=e[13],y=e[14],b=e[15];return t[0]=u*(h*b-p*y)-l*(c*b-s*y)+v*(c*p-s*h),t[1]=-(r*(h*b-p*y)-l*(i*b-o*y)+v*(i*p-o*h)),t[2]=r*(c*b-s*y)-u*(i*b-o*y)+v*(i*s-o*c),t[3]=-(r*(c*p-s*h)-u*(i*p-o*h)+l*(i*s-o*c)),t[4]=-(a*(h*b-p*y)-f*(c*b-s*y)+d*(c*p-s*h)),t[5]=n*(h*b-p*y)-f*(i*b-o*y)+d*(i*p-o*h),t[6]=-(n*(c*b-s*y)-a*(i*b-o*y)+d*(i*s-o*c)),t[7]=n*(c*p-s*h)-a*(i*p-o*h)+f*(i*s-o*c),t[8]=a*(l*b-p*v)-f*(u*b-s*v)+d*(u*p-s*l),t[9]=-(n*(l*b-p*v)-f*(r*b-o*v)+d*(r*p-o*l)),t[10]=n*(u*b-s*v)-a*(r*b-o*v)+d*(r*s-o*u),t[11]=-(n*(u*p-s*l)-a*(r*p-o*l)+f*(r*s-o*u)),t[12]=-(a*(l*y-h*v)-f*(u*y-c*v)+d*(u*h-c*l)),t[13]=n*(l*y-h*v)-f*(r*y-i*v)+d*(r*h-i*l),t[14]=-(n*(u*y-c*v)-a*(r*y-i*v)+d*(r*c-i*u)),t[15]=n*(u*h-c*l)-a*(r*h-i*l)+f*(r*c-i*u),t},i.determinant=function(t){var e=t[0],n=t[1],r=t[2],i=t[3],o=t[4],a=t[5],u=t[6],c=t[7],s=t[8],f=t[9],l=t[10],h=t[11],p=t[12],d=t[13],v=t[14],y=t[15],b=e*a-n*o,g=e*u-r*o,m=e*c-i*o,_=n*u-r*a,w=n*c-i*a,O=r*c-i*u,M=s*d-f*p,E=s*v-l*p,k=s*y-h*p,P=f*v-l*d,j=f*y-h*d,T=l*y-h*v;return b*T-g*j+m*P+_*k-w*E+O*M},i.multiply=function(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3],u=e[4],c=e[5],s=e[6],f=e[7],l=e[8],h=e[9],p=e[10],d=e[11],v=e[12],y=e[13],b=e[14],g=e[15],m=n[0],_=n[1],w=n[2],O=n[3];return t[0]=m*r+_*u+w*l+O*v,t[1]=m*i+_*c+w*h+O*y,t[2]=m*o+_*s+w*p+O*b,t[3]=m*a+_*f+w*d+O*g,m=n[4],_=n[5],w=n[6],O=n[7],t[4]=m*r+_*u+w*l+O*v,t[5]=m*i+_*c+w*h+O*y,t[6]=m*o+_*s+w*p+O*b,t[7]=m*a+_*f+w*d+O*g,m=n[8],_=n[9],w=n[10],O=n[11],t[8]=m*r+_*u+w*l+O*v,t[9]=m*i+_*c+w*h+O*y,t[10]=m*o+_*s+w*p+O*b,t[11]=m*a+_*f+w*d+O*g,m=n[12],_=n[13],w=n[14],O=n[15],t[12]=m*r+_*u+w*l+O*v,t[13]=m*i+_*c+w*h+O*y,t[14]=m*o+_*s+w*p+O*b,t[15]=m*a+_*f+w*d+O*g,t},i.mul=i.multiply,i.translate=function(t,e,n){var r,i,o,a,u,c,s,f,l,h,p,d,v=n[0],y=n[1],b=n[2];return e===t?(t[12]=e[0]*v+e[4]*y+e[8]*b+e[12],t[13]=e[1]*v+e[5]*y+e[9]*b+e[13],t[14]=e[2]*v+e[6]*y+e[10]*b+e[14],t[15]=e[3]*v+e[7]*y+e[11]*b+e[15]):(r=e[0],i=e[1],o=e[2],a=e[3],u=e[4],c=e[5],s=e[6],f=e[7],l=e[8],h=e[9],p=e[10],d=e[11],t[0]=r,t[1]=i,t[2]=o,t[3]=a,t[4]=u,t[5]=c,t[6]=s,t[7]=f,t[8]=l,t[9]=h,t[10]=p,t[11]=d,t[12]=r*v+u*y+l*b+e[12],t[13]=i*v+c*y+h*b+e[13],t[14]=o*v+s*y+p*b+e[14],t[15]=a*v+f*y+d*b+e[15]),t},i.scale=function(t,e,n){var r=n[0],i=n[1],o=n[2];return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*i,t[5]=e[5]*i,t[6]=e[6]*i,t[7]=e[7]*i,t[8]=e[8]*o,t[9]=e[9]*o,t[10]=e[10]*o,t[11]=e[11]*o,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},i.rotate=function(t,e,n,i){var o,a,u,c,s,f,l,h,p,d,v,y,b,g,m,_,w,O,M,E,k,P,j,T,R=i[0],A=i[1],x=i[2],S=Math.sqrt(R*R+A*A+x*x);return Math.abs(S)<r.EPSILON?null:(S=1/S,R*=S,A*=S,x*=S,o=Math.sin(n),a=Math.cos(n),u=1-a,c=e[0],s=e[1],f=e[2],l=e[3],h=e[4],p=e[5],d=e[6],v=e[7],y=e[8],b=e[9],g=e[10],m=e[11],_=R*R*u+a,w=A*R*u+x*o,O=x*R*u-A*o,M=R*A*u-x*o,E=A*A*u+a,k=x*A*u+R*o,P=R*x*u+A*o,j=A*x*u-R*o,T=x*x*u+a,t[0]=c*_+h*w+y*O,t[1]=s*_+p*w+b*O,t[2]=f*_+d*w+g*O,t[3]=l*_+v*w+m*O,t[4]=c*M+h*E+y*k,t[5]=s*M+p*E+b*k,t[6]=f*M+d*E+g*k,t[7]=l*M+v*E+m*k,t[8]=c*P+h*j+y*T,t[9]=s*P+p*j+b*T,t[10]=f*P+d*j+g*T,t[11]=l*P+v*j+m*T,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)},i.rotateX=function(t,e,n){var r=Math.sin(n),i=Math.cos(n),o=e[4],a=e[5],u=e[6],c=e[7],s=e[8],f=e[9],l=e[10],h=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=o*i+s*r,t[5]=a*i+f*r,t[6]=u*i+l*r,t[7]=c*i+h*r,t[8]=s*i-o*r,t[9]=f*i-a*r,t[10]=l*i-u*r,t[11]=h*i-c*r,t},i.rotateY=function(t,e,n){var r=Math.sin(n),i=Math.cos(n),o=e[0],a=e[1],u=e[2],c=e[3],s=e[8],f=e[9],l=e[10],h=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*i-s*r,t[1]=a*i-f*r,t[2]=u*i-l*r,t[3]=c*i-h*r,t[8]=o*r+s*i,t[9]=a*r+f*i,t[10]=u*r+l*i,t[11]=c*r+h*i,t},i.rotateZ=function(t,e,n){var r=Math.sin(n),i=Math.cos(n),o=e[0],a=e[1],u=e[2],c=e[3],s=e[4],f=e[5],l=e[6],h=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*i+s*r,t[1]=a*i+f*r,t[2]=u*i+l*r,t[3]=c*i+h*r,t[4]=s*i-o*r,t[5]=f*i-a*r,t[6]=l*i-u*r,t[7]=h*i-c*r,t},i.fromTranslation=function(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t},i.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},i.fromRotation=function(t,e,n){var i,o,a,u=n[0],c=n[1],s=n[2],f=Math.sqrt(u*u+c*c+s*s);return Math.abs(f)<r.EPSILON?null:(f=1/f,u*=f,c*=f,s*=f,i=Math.sin(e),o=Math.cos(e),a=1-o,t[0]=u*u*a+o,t[1]=c*u*a+s*i,t[2]=s*u*a-c*i,t[3]=0,t[4]=u*c*a-s*i,t[5]=c*c*a+o,t[6]=s*c*a+u*i,t[7]=0,t[8]=u*s*a+c*i,t[9]=c*s*a-u*i,t[10]=s*s*a+o,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t)},i.fromXRotation=function(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=r,t[6]=n,t[7]=0,t[8]=0,t[9]=-n,t[10]=r,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},i.fromYRotation=function(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=0,t[2]=-n,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=n,t[9]=0,t[10]=r,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},i.fromZRotation=function(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=n,t[2]=0,t[3]=0,t[4]=-n,t[5]=r,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},i.fromRotationTranslation=function(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3],u=r+r,c=i+i,s=o+o,f=r*u,l=r*c,h=r*s,p=i*c,d=i*s,v=o*s,y=a*u,b=a*c,g=a*s;return t[0]=1-(p+v),t[1]=l+g,t[2]=h-b,t[3]=0,t[4]=l-g,t[5]=1-(f+v),t[6]=d+y,t[7]=0,t[8]=h+b,t[9]=d-y,t[10]=1-(f+p),t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t},i.fromRotationTranslationScale=function(t,e,n,r){var i=e[0],o=e[1],a=e[2],u=e[3],c=i+i,s=o+o,f=a+a,l=i*c,h=i*s,p=i*f,d=o*s,v=o*f,y=a*f,b=u*c,g=u*s,m=u*f,_=r[0],w=r[1],O=r[2];return t[0]=(1-(d+y))*_,t[1]=(h+m)*_,t[2]=(p-g)*_,t[3]=0,t[4]=(h-m)*w,t[5]=(1-(l+y))*w,t[6]=(v+b)*w,t[7]=0,t[8]=(p+g)*O,t[9]=(v-b)*O,t[10]=(1-(l+d))*O,t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t},i.fromRotationTranslationScaleOrigin=function(t,e,n,r,i){var o=e[0],a=e[1],u=e[2],c=e[3],s=o+o,f=a+a,l=u+u,h=o*s,p=o*f,d=o*l,v=a*f,y=a*l,b=u*l,g=c*s,m=c*f,_=c*l,w=r[0],O=r[1],M=r[2],E=i[0],k=i[1],P=i[2];return t[0]=(1-(v+b))*w,t[1]=(p+_)*w,t[2]=(d-m)*w,t[3]=0,t[4]=(p-_)*O,t[5]=(1-(h+b))*O,t[6]=(y+g)*O,t[7]=0,t[8]=(d+m)*M,t[9]=(y-g)*M,t[10]=(1-(h+v))*M,t[11]=0,t[12]=n[0]+E-(t[0]*E+t[4]*k+t[8]*P),t[13]=n[1]+k-(t[1]*E+t[5]*k+t[9]*P),t[14]=n[2]+P-(t[2]*E+t[6]*k+t[10]*P),t[15]=1,t},i.fromQuat=function(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],a=n+n,u=r+r,c=i+i,s=n*a,f=r*a,l=r*u,h=i*a,p=i*u,d=i*c,v=o*a,y=o*u,b=o*c;return t[0]=1-l-d,t[1]=f+b,t[2]=h-y,t[3]=0,t[4]=f-b,t[5]=1-s-d,t[6]=p+v,t[7]=0,t[8]=h+y,t[9]=p-v,t[10]=1-s-l,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},i.frustum=function(t,e,n,r,i,o,a){var u=1/(n-e),c=1/(i-r),s=1/(o-a);return t[0]=2*o*u,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*o*c,t[6]=0,t[7]=0,t[8]=(n+e)*u,t[9]=(i+r)*c,t[10]=(a+o)*s,t[11]=-1,t[12]=0,t[13]=0,t[14]=a*o*2*s,t[15]=0,t},i.perspective=function(t,e,n,r,i){var o=1/Math.tan(e/2),a=1/(r-i);return t[0]=o/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=o,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=(i+r)*a,t[11]=-1,t[12]=0,t[13]=0,t[14]=2*i*r*a,t[15]=0,t},i.perspectiveFromFieldOfView=function(t,e,n,r){var i=Math.tan(e.upDegrees*Math.PI/180),o=Math.tan(e.downDegrees*Math.PI/180),a=Math.tan(e.leftDegrees*Math.PI/180),u=Math.tan(e.rightDegrees*Math.PI/180),c=2/(a+u),s=2/(i+o);return t[0]=c,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=s,t[6]=0,t[7]=0,t[8]=-((a-u)*c*.5),t[9]=(i-o)*s*.5,t[10]=r/(n-r),t[11]=-1,t[12]=0,t[13]=0,t[14]=r*n/(n-r),t[15]=0,t},i.ortho=function(t,e,n,r,i,o,a){var u=1/(e-n),c=1/(r-i),s=1/(o-a);return t[0]=-2*u,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*c,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*s,t[11]=0,t[12]=(e+n)*u,t[13]=(i+r)*c,t[14]=(a+o)*s,t[15]=1,t},i.lookAt=function(t,e,n,o){var a,u,c,s,f,l,h,p,d,v,y=e[0],b=e[1],g=e[2],m=o[0],_=o[1],w=o[2],O=n[0],M=n[1],E=n[2];return Math.abs(y-O)<r.EPSILON&&Math.abs(b-M)<r.EPSILON&&Math.abs(g-E)<r.EPSILON?i.identity(t):(h=y-O,p=b-M,d=g-E,v=1/Math.sqrt(h*h+p*p+d*d),h*=v,p*=v,d*=v,a=_*d-w*p,u=w*h-m*d,c=m*p-_*h,v=Math.sqrt(a*a+u*u+c*c),v?(v=1/v,a*=v,u*=v,c*=v):(a=0,u=0,c=0),s=p*c-d*u,f=d*a-h*c,l=h*u-p*a,v=Math.sqrt(s*s+f*f+l*l),v?(v=1/v,s*=v,f*=v,l*=v):(s=0,f=0,l=0),t[0]=a,t[1]=s,t[2]=h,t[3]=0,t[4]=u,t[5]=f,t[6]=p,t[7]=0,t[8]=c,t[9]=l,t[10]=d,t[11]=0,t[12]=-(a*y+u*b+c*g),t[13]=-(s*y+f*b+l*g),t[14]=-(h*y+p*b+d*g),t[15]=1,t)},i.str=function(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"},i.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+Math.pow(t[6],2)+Math.pow(t[7],2)+Math.pow(t[8],2)+Math.pow(t[9],2)+Math.pow(t[10],2)+Math.pow(t[11],2)+Math.pow(t[12],2)+Math.pow(t[13],2)+Math.pow(t[14],2)+Math.pow(t[15],2))},t.exports=i},function(t,e,n){"use strict";var r=n(2),i=n(5),o=n(8),a=n(9),u={};u.create=function(){var t=new r.ARRAY_TYPE(4);return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t},u.rotationTo=function(){var t=o.create(),e=o.fromValues(1,0,0),n=o.fromValues(0,1,0);return function(r,i,a){var c=o.dot(i,a);return-.999999>c?(o.cross(t,e,i),o.length(t)<1e-6&&o.cross(t,n,i),o.normalize(t,t),u.setAxisAngle(r,t,Math.PI),r):c>.999999?(r[0]=0,r[1]=0,r[2]=0,r[3]=1,r):(o.cross(t,i,a),r[0]=t[0],r[1]=t[1],r[2]=t[2],r[3]=1+c,u.normalize(r,r))}}(),u.setAxes=function(){var t=i.create();return function(e,n,r,i){return t[0]=r[0],t[3]=r[1],t[6]=r[2],t[1]=i[0],t[4]=i[1],t[7]=i[2],t[2]=-n[0],t[5]=-n[1],t[8]=-n[2],u.normalize(e,u.fromMat3(e,t))}}(),u.clone=a.clone,u.fromValues=a.fromValues,u.copy=a.copy,u.set=a.set,u.identity=function(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t},u.setAxisAngle=function(t,e,n){n=.5*n;var r=Math.sin(n);return t[0]=r*e[0],t[1]=r*e[1],t[2]=r*e[2],t[3]=Math.cos(n),t},u.add=a.add,u.multiply=function(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3],u=n[0],c=n[1],s=n[2],f=n[3];return t[0]=r*f+a*u+i*s-o*c,t[1]=i*f+a*c+o*u-r*s,t[2]=o*f+a*s+r*c-i*u,t[3]=a*f-r*u-i*c-o*s,t},u.mul=u.multiply,u.scale=a.scale,u.rotateX=function(t,e,n){n*=.5;var r=e[0],i=e[1],o=e[2],a=e[3],u=Math.sin(n),c=Math.cos(n);return t[0]=r*c+a*u,t[1]=i*c+o*u,t[2]=o*c-i*u,t[3]=a*c-r*u,t},u.rotateY=function(t,e,n){n*=.5;var r=e[0],i=e[1],o=e[2],a=e[3],u=Math.sin(n),c=Math.cos(n);return t[0]=r*c-o*u,t[1]=i*c+a*u,t[2]=o*c+r*u,t[3]=a*c-i*u,t},u.rotateZ=function(t,e,n){n*=.5;var r=e[0],i=e[1],o=e[2],a=e[3],u=Math.sin(n),c=Math.cos(n);return t[0]=r*c+i*u,t[1]=i*c-r*u,t[2]=o*c+a*u,t[3]=a*c-o*u,t},u.calculateW=function(t,e){var n=e[0],r=e[1],i=e[2];return t[0]=n,t[1]=r,t[2]=i,t[3]=Math.sqrt(Math.abs(1-n*n-r*r-i*i)),t},u.dot=a.dot,u.lerp=a.lerp,u.slerp=function(t,e,n,r){var i,o,a,u,c,s=e[0],f=e[1],l=e[2],h=e[3],p=n[0],d=n[1],v=n[2],y=n[3];return o=s*p+f*d+l*v+h*y,0>o&&(o=-o,p=-p,d=-d,v=-v,y=-y),1-o>1e-6?(i=Math.acos(o),a=Math.sin(i),u=Math.sin((1-r)*i)/a,c=Math.sin(r*i)/a):(u=1-r,c=r),t[0]=u*s+c*p,t[1]=u*f+c*d,t[2]=u*l+c*v,t[3]=u*h+c*y,t},u.sqlerp=function(){var t=u.create(),e=u.create();return function(n,r,i,o,a,c){return u.slerp(t,r,a,c),u.slerp(e,i,o,c),u.slerp(n,t,e,2*c*(1-c)),n}}(),u.invert=function(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],a=n*n+r*r+i*i+o*o,u=a?1/a:0;return t[0]=-n*u,t[1]=-r*u,t[2]=-i*u,t[3]=o*u,t},u.conjugate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t},u.length=a.length,u.len=u.length,u.squaredLength=a.squaredLength,u.sqrLen=u.squaredLength,u.normalize=a.normalize,u.fromMat3=function(t,e){var n,r=e[0]+e[4]+e[8];if(r>0)n=Math.sqrt(r+1),t[3]=.5*n,n=.5/n,t[0]=(e[5]-e[7])*n,t[1]=(e[6]-e[2])*n,t[2]=(e[1]-e[3])*n;else{var i=0;e[4]>e[0]&&(i=1),e[8]>e[3*i+i]&&(i=2);var o=(i+1)%3,a=(i+2)%3;n=Math.sqrt(e[3*i+i]-e[3*o+o]-e[3*a+a]+1),t[i]=.5*n,n=.5/n,t[3]=(e[3*o+a]-e[3*a+o])*n,t[o]=(e[3*o+i]+e[3*i+o])*n,t[a]=(e[3*a+i]+e[3*i+a])*n}return t},u.str=function(t){return"quat("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},t.exports=u},function(t,e,n){"use strict";var r=n(2),i={};i.create=function(){var t=new r.ARRAY_TYPE(3);return t[0]=0,t[1]=0,t[2]=0,t},i.clone=function(t){var e=new r.ARRAY_TYPE(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e},i.fromValues=function(t,e,n){var i=new r.ARRAY_TYPE(3);return i[0]=t,i[1]=e,i[2]=n,i},i.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t},i.set=function(t,e,n,r){return t[0]=e,t[1]=n,t[2]=r,t},i.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t},i.subtract=function(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t},i.sub=i.subtract,i.multiply=function(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t[2]=e[2]*n[2],t},i.mul=i.multiply,i.divide=function(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t[2]=e[2]/n[2],t},i.div=i.divide,i.min=function(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t[2]=Math.min(e[2],n[2]),t},i.max=function(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t[2]=Math.max(e[2],n[2]),t},i.scale=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t},i.scaleAndAdd=function(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t},i.distance=function(t,e){var n=e[0]-t[0],r=e[1]-t[1],i=e[2]-t[2];return Math.sqrt(n*n+r*r+i*i)},i.dist=i.distance,i.squaredDistance=function(t,e){var n=e[0]-t[0],r=e[1]-t[1],i=e[2]-t[2];return n*n+r*r+i*i},i.sqrDist=i.squaredDistance,i.length=function(t){var e=t[0],n=t[1],r=t[2];return Math.sqrt(e*e+n*n+r*r)},i.len=i.length,i.squaredLength=function(t){var e=t[0],n=t[1],r=t[2];return e*e+n*n+r*r},i.sqrLen=i.squaredLength,i.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t},i.inverse=function(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t},i.normalize=function(t,e){var n=e[0],r=e[1],i=e[2],o=n*n+r*r+i*i;return o>0&&(o=1/Math.sqrt(o),t[0]=e[0]*o,t[1]=e[1]*o,t[2]=e[2]*o),t},i.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]},i.cross=function(t,e,n){var r=e[0],i=e[1],o=e[2],a=n[0],u=n[1],c=n[2];return t[0]=i*c-o*u,t[1]=o*a-r*c,t[2]=r*u-i*a,t},i.lerp=function(t,e,n,r){var i=e[0],o=e[1],a=e[2];return t[0]=i+r*(n[0]-i),t[1]=o+r*(n[1]-o),t[2]=a+r*(n[2]-a),t},i.hermite=function(t,e,n,r,i,o){var a=o*o,u=a*(2*o-3)+1,c=a*(o-2)+o,s=a*(o-1),f=a*(3-2*o);return t[0]=e[0]*u+n[0]*c+r[0]*s+i[0]*f,t[1]=e[1]*u+n[1]*c+r[1]*s+i[1]*f,t[2]=e[2]*u+n[2]*c+r[2]*s+i[2]*f,t},i.bezier=function(t,e,n,r,i,o){var a=1-o,u=a*a,c=o*o,s=u*a,f=3*o*u,l=3*c*a,h=c*o;return t[0]=e[0]*s+n[0]*f+r[0]*l+i[0]*h,t[1]=e[1]*s+n[1]*f+r[1]*l+i[1]*h,t[2]=e[2]*s+n[2]*f+r[2]*l+i[2]*h,t},i.random=function(t,e){e=e||1;var n=2*r.RANDOM()*Math.PI,i=2*r.RANDOM()-1,o=Math.sqrt(1-i*i)*e;return t[0]=Math.cos(n)*o,t[1]=Math.sin(n)*o,t[2]=i*e,t},i.transformMat4=function(t,e,n){var r=e[0],i=e[1],o=e[2],a=n[3]*r+n[7]*i+n[11]*o+n[15];return a=a||1,t[0]=(n[0]*r+n[4]*i+n[8]*o+n[12])/a,t[1]=(n[1]*r+n[5]*i+n[9]*o+n[13])/a,t[2]=(n[2]*r+n[6]*i+n[10]*o+n[14])/a,t},i.transformMat3=function(t,e,n){var r=e[0],i=e[1],o=e[2];return t[0]=r*n[0]+i*n[3]+o*n[6],t[1]=r*n[1]+i*n[4]+o*n[7],t[2]=r*n[2]+i*n[5]+o*n[8],t},i.transformQuat=function(t,e,n){var r=e[0],i=e[1],o=e[2],a=n[0],u=n[1],c=n[2],s=n[3],f=s*r+u*o-c*i,l=s*i+c*r-a*o,h=s*o+a*i-u*r,p=-a*r-u*i-c*o;return t[0]=f*s+p*-a+l*-c-h*-u,t[1]=l*s+p*-u+h*-a-f*-c,t[2]=h*s+p*-c+f*-u-l*-a,t},i.rotateX=function(t,e,n,r){var i=[],o=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],o[0]=i[0],o[1]=i[1]*Math.cos(r)-i[2]*Math.sin(r),o[2]=i[1]*Math.sin(r)+i[2]*Math.cos(r),t[0]=o[0]+n[0],t[1]=o[1]+n[1],t[2]=o[2]+n[2],t},i.rotateY=function(t,e,n,r){var i=[],o=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],o[0]=i[2]*Math.sin(r)+i[0]*Math.cos(r),o[1]=i[1],o[2]=i[2]*Math.cos(r)-i[0]*Math.sin(r),t[0]=o[0]+n[0],t[1]=o[1]+n[1],t[2]=o[2]+n[2],t},i.rotateZ=function(t,e,n,r){var i=[],o=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],o[0]=i[0]*Math.cos(r)-i[1]*Math.sin(r),o[1]=i[0]*Math.sin(r)+i[1]*Math.cos(r),o[2]=i[2],t[0]=o[0]+n[0],t[1]=o[1]+n[1],t[2]=o[2]+n[2],t},i.forEach=function(){var t=i.create();return function(e,n,r,i,o,a){var u,c;for(n||(n=3),r||(r=0),c=i?Math.min(i*n+r,e.length):e.length,u=r;c>u;u+=n)t[0]=e[u],t[1]=e[u+1],t[2]=e[u+2],o(t,t,a),e[u]=t[0],e[u+1]=t[1],e[u+2]=t[2];return e}}(),i.angle=function(t,e){var n=i.fromValues(t[0],t[1],t[2]),r=i.fromValues(e[0],e[1],e[2]);i.normalize(n,n),i.normalize(r,r);var o=i.dot(n,r);return o>1?0:Math.acos(o)},i.str=function(t){return"vec3("+t[0]+", "+t[1]+", "+t[2]+")"},t.exports=i},function(t,e,n){"use strict";var r=n(2),i={};i.create=function(){var t=new r.ARRAY_TYPE(4);return t[0]=0,t[1]=0,t[2]=0,t[3]=0,t},i.clone=function(t){var e=new r.ARRAY_TYPE(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},i.fromValues=function(t,e,n,i){var o=new r.ARRAY_TYPE(4);return o[0]=t,o[1]=e,o[2]=n,o[3]=i,o},i.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},i.set=function(t,e,n,r,i){return t[0]=e,t[1]=n,t[2]=r,t[3]=i,t},i.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t},i.subtract=function(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t},i.sub=i.subtract,i.multiply=function(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t[2]=e[2]*n[2],t[3]=e[3]*n[3],t},i.mul=i.multiply,i.divide=function(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t[2]=e[2]/n[2],t[3]=e[3]/n[3],t},i.div=i.divide,i.min=function(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t[2]=Math.min(e[2],n[2]),t[3]=Math.min(e[3],n[3]),t},i.max=function(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t[2]=Math.max(e[2],n[2]),t[3]=Math.max(e[3],n[3]),t},i.scale=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t},i.scaleAndAdd=function(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t[3]=e[3]+n[3]*r,t},i.distance=function(t,e){var n=e[0]-t[0],r=e[1]-t[1],i=e[2]-t[2],o=e[3]-t[3];return Math.sqrt(n*n+r*r+i*i+o*o)},i.dist=i.distance,i.squaredDistance=function(t,e){var n=e[0]-t[0],r=e[1]-t[1],i=e[2]-t[2],o=e[3]-t[3];return n*n+r*r+i*i+o*o},i.sqrDist=i.squaredDistance,i.length=function(t){var e=t[0],n=t[1],r=t[2],i=t[3];return Math.sqrt(e*e+n*n+r*r+i*i)},i.len=i.length,i.squaredLength=function(t){var e=t[0],n=t[1],r=t[2],i=t[3];return e*e+n*n+r*r+i*i},i.sqrLen=i.squaredLength,i.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t},i.inverse=function(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t[3]=1/e[3],t},i.normalize=function(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],a=n*n+r*r+i*i+o*o;return a>0&&(a=1/Math.sqrt(a),t[0]=n*a,t[1]=r*a,t[2]=i*a,t[3]=o*a),t},i.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]},i.lerp=function(t,e,n,r){var i=e[0],o=e[1],a=e[2],u=e[3];return t[0]=i+r*(n[0]-i),t[1]=o+r*(n[1]-o),t[2]=a+r*(n[2]-a),t[3]=u+r*(n[3]-u),t},i.random=function(t,e){return e=e||1,t[0]=r.RANDOM(),t[1]=r.RANDOM(),t[2]=r.RANDOM(),t[3]=r.RANDOM(),i.normalize(t,t),i.scale(t,t,e),t},i.transformMat4=function(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3];return t[0]=n[0]*r+n[4]*i+n[8]*o+n[12]*a,t[1]=n[1]*r+n[5]*i+n[9]*o+n[13]*a,t[2]=n[2]*r+n[6]*i+n[10]*o+n[14]*a,t[3]=n[3]*r+n[7]*i+n[11]*o+n[15]*a,t},i.transformQuat=function(t,e,n){var r=e[0],i=e[1],o=e[2],a=n[0],u=n[1],c=n[2],s=n[3],f=s*r+u*o-c*i,l=s*i+c*r-a*o,h=s*o+a*i-u*r,p=-a*r-u*i-c*o;return t[0]=f*s+p*-a+l*-c-h*-u,t[1]=l*s+p*-u+h*-a-f*-c,t[2]=h*s+p*-c+f*-u-l*-a,t[3]=e[3],t},i.forEach=function(){var t=i.create();return function(e,n,r,i,o,a){var u,c;for(n||(n=4),r||(r=0),c=i?Math.min(i*n+r,e.length):e.length,u=r;c>u;u+=n)t[0]=e[u],t[1]=e[u+1],t[2]=e[u+2],t[3]=e[u+3],o(t,t,a),e[u]=t[0],e[u+1]=t[1],e[u+2]=t[2],e[u+3]=t[3];return e}}(),i.str=function(t){return"vec4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},t.exports=i},function(t,e,n){"use strict";var r=n(2),i={};i.create=function(){var t=new r.ARRAY_TYPE(2);return t[0]=0,t[1]=0,t},i.clone=function(t){var e=new r.ARRAY_TYPE(2);return e[0]=t[0],e[1]=t[1],e},i.fromValues=function(t,e){var n=new r.ARRAY_TYPE(2);return n[0]=t,n[1]=e,n},i.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t},i.set=function(t,e,n){return t[0]=e,t[1]=n,t},i.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t},i.subtract=function(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t},i.sub=i.subtract,i.multiply=function(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t},i.mul=i.multiply,i.divide=function(t,e,n){return t[0]=e[0]/n[0],
t[1]=e[1]/n[1],t},i.div=i.divide,i.min=function(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t},i.max=function(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t},i.scale=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t},i.scaleAndAdd=function(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t},i.distance=function(t,e){var n=e[0]-t[0],r=e[1]-t[1];return Math.sqrt(n*n+r*r)},i.dist=i.distance,i.squaredDistance=function(t,e){var n=e[0]-t[0],r=e[1]-t[1];return n*n+r*r},i.sqrDist=i.squaredDistance,i.length=function(t){var e=t[0],n=t[1];return Math.sqrt(e*e+n*n)},i.len=i.length,i.squaredLength=function(t){var e=t[0],n=t[1];return e*e+n*n},i.sqrLen=i.squaredLength,i.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t},i.inverse=function(t,e){return t[0]=1/e[0],t[1]=1/e[1],t},i.normalize=function(t,e){var n=e[0],r=e[1],i=n*n+r*r;return i>0&&(i=1/Math.sqrt(i),t[0]=e[0]*i,t[1]=e[1]*i),t},i.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]},i.cross=function(t,e,n){var r=e[0]*n[1]-e[1]*n[0];return t[0]=t[1]=0,t[2]=r,t},i.lerp=function(t,e,n,r){var i=e[0],o=e[1];return t[0]=i+r*(n[0]-i),t[1]=o+r*(n[1]-o),t},i.random=function(t,e){e=e||1;var n=2*r.RANDOM()*Math.PI;return t[0]=Math.cos(n)*e,t[1]=Math.sin(n)*e,t},i.transformMat2=function(t,e,n){var r=e[0],i=e[1];return t[0]=n[0]*r+n[2]*i,t[1]=n[1]*r+n[3]*i,t},i.transformMat2d=function(t,e,n){var r=e[0],i=e[1];return t[0]=n[0]*r+n[2]*i+n[4],t[1]=n[1]*r+n[3]*i+n[5],t},i.transformMat3=function(t,e,n){var r=e[0],i=e[1];return t[0]=n[0]*r+n[3]*i+n[6],t[1]=n[1]*r+n[4]*i+n[7],t},i.transformMat4=function(t,e,n){var r=e[0],i=e[1];return t[0]=n[0]*r+n[4]*i+n[12],t[1]=n[1]*r+n[5]*i+n[13],t},i.forEach=function(){var t=i.create();return function(e,n,r,i,o,a){var u,c;for(n||(n=2),r||(r=0),c=i?Math.min(i*n+r,e.length):e.length,u=r;c>u;u+=n)t[0]=e[u],t[1]=e[u+1],o(t,t,a),e[u]=t[0],e[u+1]=t[1];return e}}(),i.str=function(t){return"vec2("+t[0]+", "+t[1]+")"},t.exports=i},function(t,e){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),i={},o=function(){function t(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],r=e.name,i=void 0===r?"entity":r;n(this,t),this.name=i,this.basename=i,this.inheritance=["Entity"]}return r(t,[{key:"isType",value:function(t){return-1!==this.inheritance.indexOf(t)}},{key:"name",get:function(){return this._name},set:function(t){void 0===i[t]&&(i[t]=-1),i[t]++,this._name=t+".0"+i[t]}},{key:"basename",get:function(){return this._basename},set:function(t){this._basename=t}},{key:"inheritance",get:function(){return this._inheritance},set:function(t){this._inheritance=t}}]),t}();e["default"]=o},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var u=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),c=n(13),s=n(11),f=r(s),l=function(t){function e(){var t=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],n=t.attribute,r=t.length,a=t.name,u=void 0===a?"attribute":a,c=t.format,s=void 0===c?"FLOAT":c,f=t.normalized,l=void 0===f?!1:f,h=t.offset,p=void 0===h?0:h;i(this,e);var d=o(this,Object.getPrototypeOf(e).call(this,{name:u}));return d.attribute=n,d.location=void 0,d.length=r,d.format=s,d.normalized=l,d.offset=p,d.inheritance=["Entity","Attribute"],d}return a(e,t),u(e,[{key:"getByteCount",value:function(t){return this.length*t}},{key:"locate",value:function(t){return this.location=c.gl.getAttribLocation(t.buffer,"a_"+this.attribute)}},{key:"enable",value:function(t){var e=arguments.length<=1||void 0===arguments[1]?0:arguments[1],n=this.locate(t);~n&&(c.gl.enableVertexAttribArray(n),c.gl.vertexAttribPointer(n,this.length,this.format,this.normalized,e,this.offset))}},{key:"disable",value:function(){var t=this.location;~t&&c.gl.disableVertexAttribArray(t)}},{key:"attribute",get:function(){return this._attribute},set:function(t){this._attribute=t}},{key:"location",get:function(){return this._location},set:function(t){this._location=t}},{key:"length",get:function(){return this._length},set:function(t){this._length=t}},{key:"format",get:function(){return c.gl[this._format]},set:function(t){this._format=t}},{key:"normalized",get:function(){return this._normalized},set:function(t){this._normalized=t}},{key:"offset",get:function(){return this._offset},set:function(t){this._offset=t}}]),e}(f["default"]);e["default"]=l},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0}),e.gl=void 0;var u=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),c=n(11),s=r(c),f=void 0,l=function(t){function n(){var t=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],e=t.name,r=void 0===e?"canvas":e,a=t.selector,u=void 0===a?"canvas":a,c=t.width,s=void 0===c?window.innerWidth:c,f=t.height,l=void 0===f?window.innerHeight:f,h=t.dpi,p=void 0===h?window.devicePixelRatio:h;i(this,n);var d=o(this,Object.getPrototypeOf(n).call(this,{name:r}));return d.canvas=void 0,d.width=s,d.height=l,d.dpi=p,d.gl=void 0,d.inheritance=["Entity","Context"],d.prime(u),d.contextualise(),d}return a(n,t),u(n,[{key:"prime",value:function(t){var e=document.querySelector(t),n=this.width,r=this.height,i=this.dpi;e.setAttribute("width",n),e.setAttribute("height",r),e.style.width=n/i,e.style.height=r/i,this.canvas=e}},{key:"contextualise",value:function(){var t=this.canvas;this.gl=t.getContext("webgl")||t.getContext("experimental-webgl"),e.gl=f=this.gl}},{key:"use",value:function(){e.gl=f=this.gl}},{key:"canvas",get:function(){return this._canvas},set:function(t){this._canvas=t}},{key:"width",get:function(){return this._width*this._dpi},set:function(t){this._width=t}},{key:"height",get:function(){return this._height*this._dpi},set:function(t){this._height=t}},{key:"dpi",get:function(){return this._dpi},set:function(t){this._dpi=t}},{key:"gl",get:function(){return this._gl},set:function(t){this._gl=t}}]),n}(s["default"]);e.gl=f,e["default"]=l},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var u=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),c=function g(t,e,n){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,e);if(void 0===r){var i=Object.getPrototypeOf(t);return null===i?void 0:g(i,e,n)}if("value"in r)return r.value;var o=r.get;if(void 0!==o)return o.call(n)},s=n(13),f=n(1),l=n(15),h=r(l),p=n(16),d=r(p),v={x:[1,0,0],y:[0,1,0],z:[0,0,1]},y=.0174532925,b=function(t){function e(){var t=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],n=t.name,r=void 0===n?"camera":n,a=t.path,u=void 0===a?"camera":a,c=t.uniforms,s=void 0===c?["mat4 projectionMatrix","mat4 modelViewMatrix","mat3 normalMatrix"]:c,l=t.background,h=void 0===l?0:l,p=t.translucence,d=void 0===p?1:p;i(this,e);var v=o(this,Object.getPrototypeOf(e).call(this,{name:r,path:u,uniforms:s}));return v.background=h,v.translucence=d,v.modelViewMatrix=f.mat4.create(),v.projectionMatrix=f.mat4.create(),v.normalMatrix=f.mat3.create(),v.stack=[],v.inheritance=["Entity","Structure","Camera"],v}return a(e,t),u(e,[{key:"configure",value:function(){var t=this.background.concat(this.translucence);s.gl.enable(s.gl.CULL_FACE),s.gl.frontFace(s.gl.CCW),s.gl.clearColor.apply(s.gl,t)}},{key:"bind",value:function(t){f.mat3.normalFromMat4(this.normalMatrix,this.modelViewMatrix),c(Object.getPrototypeOf(e.prototype),"bind",this).call(this,t)}},{key:"save",value:function(){var t=f.mat4.clone(this.modelViewMatrix);this.stack.push(t)}},{key:"restore",value:function(){var t=this.stack;if(t.length){var e=t.pop();f.mat4.copy(this.modelViewMatrix,e)}}},{key:"scale",value:function(t,e,n){var r=this.modelViewMatrix;f.mat4.scale(r,r,arguments)}},{key:"scaleX",value:function(t){this.scale(t,1,1)}},{key:"scaleY",value:function(t){this.scale(1,t,1)}},{key:"scaleZ",value:function(t){this.scale(1,1,t)}},{key:"rotate",value:function(t){var e=arguments.length<=1||void 0===arguments[1]?"y":arguments[1],n=this.modelViewMatrix,r=t*y;f.mat4.rotate(n,n,r,v[e])}},{key:"rotateX",value:function(t){this.rotate(t,"x")}},{key:"rotateY",value:function(t){this.rotate(t,"y")}},{key:"rotateZ",value:function(t){this.rotate(t,"z")}},{key:"translate",value:function(t,e,n){var r=this.modelViewMatrix;f.mat4.translate(r,r,arguments)}},{key:"translateX",value:function(t){this.translate(t,0,0)}},{key:"translateY",value:function(t){this.translate(0,t,0)}},{key:"translateZ",value:function(t){this.translate(0,0,t)}},{key:"background",get:function(){return this._background},set:function(t){this._background=(0,h["default"])(t)}},{key:"translucence",get:function(){return this._translucence},set:function(t){this._translucence=t}},{key:"modelViewMatrix",get:function(){return this._modelViewMatrix},set:function(t){this._modelViewMatrix=t}},{key:"projectionMatrix",get:function(){return this._projectionMatrix},set:function(t){this._projectionMatrix=t}},{key:"normalMatrix",get:function(){return this._normalMatrix},set:function(t){this._normalMatrix=t}},{key:"stack",get:function(){return this._stack},set:function(t){this._stack=t}}]),e}(d["default"]);e["default"]=b},function(t,e){"use strict";function n(t){var e=t>>16&255,n=t>>8&255,r=255&t;return e/=255,n/=255,r/=255,[e,n,r]}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=n},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var u=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),c=n(11),s=r(c),f=n(17),l=r(f),h=function(t){function e(){var t=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],n=t.path,r=t.name,a=void 0===r?"structure":r,u=t.uniforms,c=void 0===u?[]:u;i(this,e);var s=o(this,Object.getPrototypeOf(e).call(this,{name:a}));return s.path=n,s.uniforms=c,s.inheritance=["Entity","Structure"],s}return a(e,t),u(e,[{key:"instantiate",value:function(t){var e=t.split(" "),n=e[0],r=e[1];return new l["default"]({path:this.path,uniform:r,format:n})}},{key:"bind",value:function(t){this.uniforms.map(this.set.bind(this,t))}},{key:"unbind",value:function(){}},{key:"set",value:function(t,e){e.set(t,this[e.uniform])}},{key:"path",get:function(){return this._path},set:function(t){this._path=t}},{key:"uniforms",get:function(){return this._uniforms},set:function(t){this._uniforms=t.map(this.instantiate.bind(this))}}]),e}(s["default"]);e["default"]=h},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var u=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),c=n(13),s=n(11),f=r(s),l={i:"1i",ivec2:"2iv",ivec3:"3iv",ivec4:"4iv",f:"1f",vec2:"2fv",vec3:"3fv",vec4:"4fv",mat2:"Matrix2fv",mat3:"Matrix3fv",mat4:"Matrix4fv",sampler:"1i"},h=function(t){function e(){var t=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],n=t.uniform,r=t.format,a=t.name,u=void 0===a?"uniform":a,c=t.path,s=void 0===c?void 0:c;i(this,e);var f=o(this,Object.getPrototypeOf(e).call(this,{name:u}));return f.path=s,f.uniform=n,f.location=void 0,f.format=r,f.method=r,f.inheritance=["Entity","Uniform"],f}return a(e,t),u(e,[{key:"locate",value:function(t){var e=this.path,n=this.uniform;return"sampler"!==this.format&&void 0!==e&&(n=[e,n].join(".")),this.location=c.gl.getUniformLocation(t.buffer,"u_"+n)}},{key:"set",value:function(t,e){var n=this.locate(t),r=this.method;null!==r.match("Matrix")?c.gl[r](n,!1,e):("boolean"==typeof e&&(e=~~e),c.gl[r](n,e))}},{key:"path",get:function(){return this._path},set:function(t){this._path=t}},{key:"uniform",get:function(){return this._uniform},set:function(t){this._uniform=t}},{key:"location",get:function(){return this._location},set:function(t){this._location=t}},{key:"format",get:function(){return this._format},set:function(t){this._format=t}},{key:"method",get:function(){return this._method},set:function(t){this._method="uniform"+l[t]}}]),e}(f["default"]);e["default"]=h},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var u=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),c=function d(t,e,n){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,e);if(void 0===r){var i=Object.getPrototypeOf(t);return null===i?void 0:d(i,e,n)}if("value"in r)return r.value;var o=r.get;if(void 0!==o)return o.call(n)},s=n(13),f=n(1),l=n(14),h=r(l),p=function(t){function e(){var t=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],n=t.path,r=t.uniforms,a=t.background,u=t.translucence,c=t.right,s=t.top,f=t.name,l=void 0===f?"orthographic.camera":f,h=t.left,p=void 0===h?-1:h,d=t.bottom,v=void 0===d?-1:d,y=t.near,b=void 0===y?.1:y,g=t.far,m=void 0===g?1:g;i(this,e);var _=o(this,Object.getPrototypeOf(e).call(this,{name:l,path:n,uniforms:r,background:a,translucence:u}));return _.left=p,_.right=c,_.bottom=v,_.top=s,_.near=b,_.far=m,_.inheritance=["Entity","Structure","Camera","OrthographicCamera"],_.configure(),_}return a(e,t),u(e,[{key:"configure",value:function(){c(Object.getPrototypeOf(e.prototype),"configure",this).call(this),f.mat4.ortho(this.projectionMatrix,this.left,this.right,this.bottom,this.top,this.near,this.far),f.mat4.identity(this.modelViewMatrix)}},{key:"bind",value:function(t){c(Object.getPrototypeOf(e.prototype),"bind",this).call(this,t),s.gl.disable(s.gl.DEPTH_TEST),s.gl.viewport(0,0,this.right,this.top)}},{key:"left",get:function(){return this._left},set:function(t){this._left=t}},{key:"right",get:function(){return this._right},set:function(t){this._right=t}},{key:"bottom",get:function(){return this._bottom},set:function(t){this._bottom=t}},{key:"top",get:function(){return this._top},set:function(t){this._top=t}},{key:"near",get:function(){return this._near},set:function(t){this._near=t}},{key:"far",get:function(){return this._far},set:function(t){this._far=t}}]),e}(h["default"]);e["default"]=p},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var u=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),c=function d(t,e,n){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,e);if(void 0===r){var i=Object.getPrototypeOf(t);return null===i?void 0:d(i,e,n)}if("value"in r)return r.value;var o=r.get;if(void 0!==o)return o.call(n)},s=n(13),f=n(1),l=n(14),h=r(l),p=function(t){function e(){var t=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],n=t.path,r=t.uniforms,a=t.background,u=t.translucence,c=t.width,s=t.height,l=t.name,h=void 0===l?"perspective.camera":l,p=t.fov,d=void 0===p?45:p,v=t.near,y=void 0===v?.1:v,b=t.far,g=void 0===b?1e3:b,m=t.direction,_=void 0===m?f.vec3.fromValues(0,0,0):m,w=t.location,O=void 0===w?f.vec3.fromValues(10,10,-10):w,M=t.up,E=void 0===M?f.vec3.fromValues(0,1,0):M;i(this,e);var k=o(this,Object.getPrototypeOf(e).call(this,{name:h,path:n,uniforms:r,background:a,translucence:u}));return k.width=c,k.height=s,k.fov=d,k.ratio=c/s,k.near=y,k.far=g,k.direction=_,k.location=O,k.up=E,k.inheritance=["Entity","Structure","Camera","PerspectiveCamera"],k.configure(),k}return a(e,t),u(e,[{key:"configure",value:function(){c(Object.getPrototypeOf(e.prototype),"configure",this).call(this);var t=this.modelViewMatrix;s.gl.clearDepth(1),s.gl.depthFunc(s.gl.LEQUAL),f.mat4.perspective(this.projectionMatrix,this.fov,this.ratio,this.near,this.far),f.mat4.identity(t),f.mat4.lookAt(t,this.location,this.direction,this.up)}},{key:"bind",value:function(t){c(Object.getPrototypeOf(e.prototype),"bind",this).call(this,t),s.gl.enable(s.gl.DEPTH_TEST),s.gl.viewport(0,0,this.width,this.height)}},{key:"width",get:function(){return this._width},set:function(t){this._width=t}},{key:"height",get:function(){return this._height},set:function(t){this._height=t}},{key:"fov",get:function(){return this._fov},set:function(t){this._fov=t}},{key:"ratio",get:function(){return this._ratio},set:function(t){this._ratio=t}},{key:"near",get:function(){return this._near},set:function(t){this._near=t}},{key:"far",get:function(){return this._far},set:function(t){this._far=t}},{key:"direction",get:function(){return this._direction},set:function(t){this._direction=t}},{key:"location",get:function(){return this._location},set:function(t){this._location=t}},{key:"up",get:function(){return this._up},set:function(t){this._up=t}}]),e}(h["default"]);e["default"]=p},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var u=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),c=n(13),s=n(11),f=r(s),l=function(t){function e(){var t=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],n=t.name,r=void 0===n?"framebuffer":n,a=t.flushable,u=void 0===a?!0:a;i(this,e);var c=o(this,Object.getPrototypeOf(e).call(this,{name:r}));return c.buffer=null,c.flushable=u,c.inheritance=["Entity","Framebuffer"],c}return a(e,t),u(e,[{key:"bind",value:function(){var t=arguments.length<=0||void 0===arguments[0]?!0:arguments[0];c.gl.bindFramebuffer(c.gl.FRAMEBUFFER,this.buffer),this.flushable&&t&&this.flush()}},{key:"unbind",value:function(){c.gl.bindFramebuffer(c.gl.FRAMEBUFFER,null)}},{key:"flush",value:function(){c.gl.clear(c.gl.COLOR_BUFFER_BIT|c.gl.DEPTH_BUFFER_BIT)}},{key:"check",value:function(){var t=c.gl.checkFramebufferStatus(c.gl.FRAMEBUFFER),e=!1;switch(t){case c.gl.FRAMEBUFFER_UNSUPPORTED:e="FRAMEBUFFER_UNSUPPORTED";break;case c.gl.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:e="FRAMEBUFFER_INCOMPLETE_ATTACHMENT";break;case c.gl.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:e="FRAMEBUFFER_INCOMPLETE_DIMENSIONS";break;case c.gl.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:e="FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT"}if(e)throw c.gl.deleteFramebuffer(this.buffer),new Error(e);return!0}},{key:"buffer",get:function(){return this._buffer},set:function(t){this._buffer=t}},{key:"flushable",get:function(){return this._flushable},set:function(t){this._flushable=t}}]),e}(f["default"]);e["default"]=l},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var u=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),c=n(13),s=n(20),f=r(s),l=function(t){function e(){var t=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],n=t.colorAttachment,r=t.depthAttachment,a=t.flushable,u=t.name,s=void 0===u?"deferred.framebuffer":u;i(this,e);var f=o(this,Object.getPrototypeOf(e).call(this,{name:s,flushable:a}));return f.buffer=c.gl.createFramebuffer(),f.colorAttachment=n,f.depthAttachment=r,f.inheritance=["Entity","Framebuffer","DeferredFramebuffer"],f.configure(),f}return a(e,t),u(e,[{key:"configure",value:function(){this.bind(!1),c.gl.framebufferTexture2D(c.gl.FRAMEBUFFER,c.gl.COLOR_ATTACHMENT0,c.gl.TEXTURE_2D,this.colorAttachment.buffer,0),c.gl.framebufferRenderbuffer(c.gl.FRAMEBUFFER,c.gl.DEPTH_ATTACHMENT,c.gl.RENDERBUFFER,this.depthAttachment.buffer),this.check(),this.unbind()}},{key:"buffer",get:function(){return this._buffer},set:function(t){this._buffer=t}},{key:"colorAttachment",get:function(){return this._colorAttachment},set:function(t){this._colorAttachment=t}},{key:"depthAttachment",get:function(){return this._depthAttachment},set:function(t){this._depthAttachment=t}}]),e}(f["default"]);e["default"]=l},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var u=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),c=n(13),s=n(20),f=r(s),l=function(t){function e(){var t=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],n=t.colorAttachment,r=t.depthAttachment,a=t.flushable,u=t.name,s=void 0===u?"depth.framebuffer":u;i(this,e);var f=o(this,Object.getPrototypeOf(e).call(this,{name:s,flushable:a}));return f.buffer=c.gl.createFramebuffer(),f.colorAttachment=n,f.depthAttachment=r,f.inheritance=["Entity","Framebuffer","DepthFramebuffer"],f.configure(),f}return a(e,t),u(e,[{key:"configure",value:function(){this.bind(!1),c.gl.framebufferTexture2D(c.gl.FRAMEBUFFER,c.gl.COLOR_ATTACHMENT0,c.gl.TEXTURE_2D,this.colorAttachment.buffer,0),c.gl.framebufferTexture2D(c.gl.FRAMEBUFFER,c.gl.DEPTH_ATTACHMENT,c.gl.TEXTURE_2D,this.depthAttachment.buffer,0),this.check(),this.unbind()}},{key:"buffer",get:function(){return this._buffer},set:function(t){this._buffer=t}},{key:"colorAttachment",get:function(){return this._colorAttachment},set:function(t){this._colorAttachment=t}},{key:"depthAttachment",get:function(){return this._depthAttachment},set:function(t){this._depthAttachment=t}}]),e}(f["default"]);e["default"]=l},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var u=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),c=n(1),s=n(15),f=r(s),l=n(16),h=r(l),p=function(t){function e(){var t=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],n=t.name,r=void 0===n?"light":n,a=t.path,u=void 0===a?"light":a,s=t.uniforms,f=void 0===s?["vec3 ambient","vec3 diffuse","vec3 specular","f intensity","vec3 location","i type"]:s,l=t.ambient,h=void 0===l?0:l,p=t.diffuse,d=void 0===p?16777215:p,v=t.specular,y=void 0===v?16777215:v,b=t.intensity,g=void 0===b?1:b,m=t.location,_=void 0===m?c.vec3.fromValues(-10,10,-10):m;i(this,e);var w=o(this,Object.getPrototypeOf(e).call(this,{name:r,path:u,uniforms:f}));return w.ambient=h,w.diffuse=d,w.specular=y,w.intensity=g,w.location=_,w.type=0,w.inheritance=["Entity","Structure","Light"],w}return a(e,t),u(e,[{key:"ambient",get:function(){return this._ambient},set:function(t){this._ambient=(0,f["default"])(t)}},{key:"diffuse",get:function(){return this._diffuse},set:function(t){this._diffuse=(0,f["default"])(t)}},{key:"specular",get:function(){return this._specular},set:function(t){this._specular=(0,f["default"])(t)}},{key:"intensity",get:function(){return this._intensity},set:function(t){this._intensity=t}},{key:"location",get:function(){return this._location},set:function(t){this._location=t}},{key:"type",get:function(){return this._type},set:function(t){this._type=t}}]),e}(h["default"]);e["default"]=p},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var u=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),c=n(23),s=r(c),f=function(t){function e(){var t=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],n=t.path,r=t.ambient,a=t.diffuse,u=t.specular,c=t.location,s=t.name,f=void 0===s?"point.light":s,l=t.uniforms,h=void 0===l?["vec3 ambient","vec3 diffuse","vec3 specular","f radius","f intensity","vec3 location","i type"]:l,p=t.radius,d=void 0===p?10:p,v=t.intensity,y=void 0===v?10:v;
i(this,e);var b=o(this,Object.getPrototypeOf(e).call(this,{name:f,path:n,uniforms:h,ambient:r,diffuse:a,specular:u,intensity:y,location:c}));return b.radius=d,b.type=2,b.inheritance=["Entity","Structure","Light","PointLight"],b}return a(e,t),u(e,[{key:"radius",get:function(){return this._radius},set:function(t){this._radius=t}}]),e}(s["default"]);e["default"]=f},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var u=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),c=function v(t,e,n){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,e);if(void 0===r){var i=Object.getPrototypeOf(t);return null===i?void 0:v(i,e,n)}if("value"in r)return r.value;var o=r.get;if(void 0!==o)return o.call(n)},s=n(15),f=r(s),l=n(16),h=r(l),p={flat:1,smooth:0},d=function(t){function e(){var t=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],n=t.name,r=void 0===n?"material":n,a=t.path,u=void 0===a?"material":a,c=t.uniforms,s=void 0===c?["sampler image","vec3 ambient","vec3 diffuse","i shading","i type"]:c,f=t.pattern,l=void 0===f?{}:f,h=t.ambient,d=void 0===h?16777215:h,v=t.diffuse,y=void 0===v?16777215:v,b=t.shading,g=void 0===b?"smooth":b;i(this,e);var m=o(this,Object.getPrototypeOf(e).call(this,{name:r,path:u,uniforms:s}));return m.ambient=d,m.diffuse=y,m.image=l.unit,m.shading=p[g],m.pattern=l,m.type=0,m.inheritance=["Entity","Structure","Material"],m}return a(e,t),u(e,[{key:"bind",value:function(t){c(Object.getPrototypeOf(e.prototype),"bind",this).call(this,t),void 0!==this.image&&this.pattern.bind()}},{key:"unbind",value:function(){c(Object.getPrototypeOf(e.prototype),"unbind",this).call(this),void 0!==this.image&&this.pattern.unbind()}},{key:"ambient",get:function(){return this._ambient},set:function(t){this._ambient=(0,f["default"])(t)}},{key:"diffuse",get:function(){return this._diffuse},set:function(t){this._diffuse=(0,f["default"])(t)}},{key:"image",get:function(){return this._image},set:function(t){this._image=t}},{key:"shading",get:function(){return this._shading},set:function(t){this._shading=p[t]}},{key:"pattern",get:function(){return this._pattern},set:function(t){this._pattern=t}},{key:"type",get:function(){return this._type},set:function(t){this._type=t}}]),e}(h["default"]);e["default"]=d},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var u=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),c=n(15),s=r(c),f=n(25),l=r(f),h=function(t){function e(){var t=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],n=t.path,r=t.pattern,a=t.ambient,u=t.diffuse,c=t.shading,s=t.name,f=void 0===s?"phong.material":s,l=t.uniforms,h=void 0===l?["sampler image","vec3 ambient","vec3 diffuse","vec3 specular","f shininess","i shading","i type"]:l,p=t.specular,d=void 0===p?16777215:p,v=t.shininess,y=void 0===v?1:v;i(this,e);var b=o(this,Object.getPrototypeOf(e).call(this,{name:f,path:n,uniforms:h,pattern:r,ambient:a,diffuse:u,shading:c}));return b.specular=d,b.shininess=y,b.type=1,b.inheritance=["Entity","Structure","Material","PhongMaterial"],b}return a(e,t),u(e,[{key:"specular",get:function(){return this._specular},set:function(t){this._specular=(0,s["default"])(t)}},{key:"shininess",get:function(){return this._shininess},set:function(t){this._shininess=t}}]),e}(l["default"]);e["default"]=h},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var u=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),c=n(1),s=n(13),f=n(11),l=r(f),h=n(28),p=r(h),d=n(25),v=r(d),y={vertices:"position",colors:"color",uvs:"uv",normals:"normal"},b=function(t){function e(){var t=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],n=t.buffers,r=t.loader,a=t.name,u=void 0===a?"mesh":a,s=t.vertices,f=void 0===s?[]:s,l=t.colors,h=void 0===l?[]:l,p=t.uvs,d=void 0===p?[]:p,y=t.normals,b=void 0===y?[]:y,g=t.indices,m=void 0===g?[]:g,_=t.usage,w=void 0===_?"STATIC_DRAW":_,O=t.primitive,M=void 0===O?"TRIANGLES":O,E=t.material,k=void 0===E?new v["default"]:E;i(this,e);var P=o(this,Object.getPrototypeOf(e).call(this,{name:u}));return P.buffers=n,P.vertices=f,P.colors=h,P.uvs=d,P.normals=b,P.indices=m,P.usage=w,P.primitive=M,P.material=k,P.scale=c.vec3.fromValues(1,1,1),P.rotation=0,P.translation=c.vec3.create(),P.inheritance=["Entity","Mesh"],P.unpack(r),P.generate(),P.configure(),P}return a(e,t),u(e,[{key:"unpack",value:function(t){void 0!==t&&(this.vertices=t.vertices,this.colors=t.colors,this.uvs=t.uvs,this.normals=t.normals,this.indices=t.indices)}},{key:"generate",value:function(){if(void 0===this.buffers){var t=[],e=Boolean(this.indices.length);for(var n in y){var r=this[n];Boolean(r.length)&&t.push("vec"+r[0].length+" "+y[n])}this.buffers=new p["default"]({attributes:t,indexed:e})}}},{key:"configure",value:function(){var t=this.buffers,e=this.usage,n=[],r=this.vertices;if(r.map(this.interleave.bind(this,n)),t.bind(),s.gl.bufferData(s.gl.ARRAY_BUFFER,new t.view(n),e),t.indexed){var i=this.indices;s.gl.bufferData(s.gl.ELEMENT_ARRAY_BUFFER,new Uint16Array(i),e),this.count=i.length}else this.count=r.length;t.unbind()}},{key:"interleave",value:function(t,e,n){var r=this.colors[n]||[],i=this.uvs[n]||[],o=this.normals[n]||[],a=[].concat(e,r,i,o);[].push.apply(t,a.map(parseFloat))}},{key:"update",value:function(){var t=arguments.length<=0||void 0===arguments[0]?this.vertices:arguments[0];if(this.usage===s.gl.DYNAMIC_DRAW){var e=this.buffers,n=[];t.map(this.interleave.bind(this,n)),e.bind(),s.gl.bufferSubData(s.gl.ARRAY_BUFFER,0,new e.view(n)),e.unbind()}else console.warn("Unable to update Mesh::"+this.name+" vertices, not DYNAMIC_*")}},{key:"draw",value:function(){var t=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],e=t.program,n=t.primitive,r=void 0===n?this.primitive:n,i=t.offset,o=void 0===i?0:i,a=t.count,u=void 0===a?this.count:a,c=this.buffers;c.bind(e),c.indexed?s.gl.drawElements(r,u,s.gl.UNSIGNED_SHORT,o):s.gl.drawArrays(r,o,u),c.unbind()}},{key:"buffers",get:function(){return this._buffers},set:function(t){this._buffers=t}},{key:"vertices",get:function(){return this._vertices},set:function(t){this._vertices=t}},{key:"colors",get:function(){return this._colors},set:function(t){this._colors=t}},{key:"uvs",get:function(){return this._uvs},set:function(t){this._uvs=t}},{key:"normals",get:function(){return this._normals},set:function(t){this._normals=t}},{key:"indices",get:function(){return this._indices},set:function(t){this._indices=t}},{key:"usage",get:function(){return this._usage},set:function(t){this._usage=s.gl[t]}},{key:"primitive",get:function(){return this._primitive},set:function(t){this._primitive=s.gl[t]}},{key:"material",get:function(){return this._material},set:function(t){this._material=t}},{key:"scale",get:function(){return this._scale},set:function(t){this._scale=t}},{key:"rotation",get:function(){return this._rotation},set:function(t){this._rotation=t}},{key:"translation",get:function(){return this._translation},set:function(t){this._translation=t}}]),e}(l["default"]);e["default"]=b},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var u=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),c=n(13),s=n(11),f=r(s),l=n(12),h=r(l),p={i:1,f:1,vec2:2,vec3:3,vec4:4},d=function(t){function e(){var t=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],n=t.name,r=void 0===n?"vertex.array.object":n,a=t.indexed,u=void 0===a?!1:a,s=t.view,f=void 0===s?Float32Array:s,l=t.attributes,h=void 0===l?[]:l;i(this,e);var p=o(this,Object.getPrototypeOf(e).call(this,{name:r}));return p.primary=c.gl.createBuffer(),p.secondary=void 0,p.indexed=u,p.stride=0,p.view=f,p.attributes=h,p.inheritance=["Entity","VertexArrayObject"],p.configure(),p}return a(e,t),u(e,[{key:"configure",value:function(){this.indexed&&(this.secondary=c.gl.createBuffer())}},{key:"generate",value:function(t){var e=this.stride,n=t.split(" "),r=p[n[0]],i=n[1],o=new h["default"]({attribute:i,length:r,offset:e});return this.stride+=o.getByteCount(this.view.BYTES_PER_ELEMENT),o}},{key:"enable",value:function(t,e){e.enable(t,this.stride)}},{key:"disable",value:function(t){t.disable()}},{key:"bind",value:function(){var t=arguments.length<=0||void 0===arguments[0]?!1:arguments[0];c.gl.bindBuffer(c.gl.ARRAY_BUFFER,this.primary),this.indexed&&c.gl.bindBuffer(c.gl.ELEMENT_ARRAY_BUFFER,this.secondary),t&&this.attributes.map(this.enable.bind(this,t))}},{key:"unbind",value:function(){c.gl.bindBuffer(c.gl.ARRAY_BUFFER,null),this.indexed&&c.gl.bindBuffer(c.gl.ELEMENT_ARRAY_BUFFER,null),this.attributes.map(this.disable)}},{key:"primary",get:function(){return this._primary},set:function(t){this._primary=t}},{key:"secondary",get:function(){return this._secondary},set:function(t){this._secondary=t}},{key:"indexed",get:function(){return this._indexed},set:function(t){this._indexed=t}},{key:"stride",get:function(){return this._stride},set:function(t){this._stride=t}},{key:"view",get:function(){return this._view},set:function(t){this._view=t}},{key:"attributes",get:function(){return this._attributes},set:function(t){this._attributes=t.map(this.generate.bind(this))}}]),e}(f["default"]);e["default"]=d},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var u=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),c=n(30),s=r(c),f=n(11),l=r(f),h=function(t){function e(){var t=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],n=t.path,r=t.name,a=void 0===r?"mesh.loader":r,u=t.indexed,c=void 0===u?!1:u;i(this,e);var s=o(this,Object.getPrototypeOf(e).call(this,{name:a}));return s.promise=s.fetch(n),s.vertices=[],s.colors=[],s.uvs=[],s.normals=[],s.tmp={vertices:[],colors:[],uvs:[],normals:[]},s.indices=[],s.indexed=c,s.inheritance=["Entity","MeshLoader"],s}return a(e,t),u(e,[{key:"fetch",value:function(t){return(0,s["default"])(t).then(this.parse.bind(this)).then(this.flush.bind(this))}},{key:"flush",value:function(){delete this.tmp}},{key:"promise",get:function(){return this._promise},set:function(t){this._promise=t}},{key:"vertices",get:function(){return this._vertices},set:function(t){this._vertices=t}},{key:"colors",get:function(){return this._colors},set:function(t){this._colors=t}},{key:"uvs",get:function(){return this._uvs},set:function(t){this._uvs=t}},{key:"normals",get:function(){return this._normals},set:function(t){this._normals=t}},{key:"indices",get:function(){return this._indices},set:function(t){this._indices=t}},{key:"indexed",get:function(){return this._indexed},set:function(t){this._indexed=t}}]),e}(l["default"]);e["default"]=h},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function i(t){var e=arguments.length<=1||void 0===arguments[1]?"text/plain":arguments[1];return(0,a["default"])(function(n,r){var i=new XMLHttpRequest;i.open("get",t),i.onload=function(){var e=i.status;if(200===e)n(i.response);else{var o=t+": "+i.statusText,a=new Error(o);r(a)}},i.setRequestHeader("contentType",e),i.send()})}Object.defineProperty(e,"__esModule",{value:!0});var o=n(31),a=r(o);e["default"]=i},function(t,e){"use strict";function n(){var t=arguments.length<=0||void 0===arguments[0]?!1:arguments[0];return t===!1?Promise:new Promise(t)}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=n},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var u=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),c=n(29),s=r(c),f=function(t){function e(){var t=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],n=t.path,r=t.indexed,a=t.name,u=void 0===a?"obj.mesh.loader":a;i(this,e);var c=o(this,Object.getPrototypeOf(e).call(this,{name:u,path:n,indexed:r}));return c.inheritance=["Entity","MeshLoader","OBJMeshLoader"],c}return a(e,t),u(e,[{key:"parse",value:function(t){t.split("\n").map(this.categorise.bind(this))}},{key:"categorise",value:function(t){var e=t.split(" "),n=e.shift(),r=this.tmp;switch(n){case"v":r.vertices.push(e.map(parseFloat));break;case"vt":r.uvs.push(e.map(parseFloat));break;case"vn":r.normals.push(e.map(parseFloat));break;case"f":e.map(this.fork.bind(this))}}},{key:"fork",value:function(t){var e=t.split("/").map(function(t){return t-1});this.indexed?this.keep(e):this.recategorise(e)}},{key:"keep",value:function(t){var e=this.tmp,n=t[0],r=t[1],i=t[2];~n&&(this.vertices[n]=e.vertices[n],this.indices.push(n)),~r&&(this.uvs[n]=e.uvs[r]),~i&&(this.normals[n]=e.normals[i])}},{key:"recategorise",value:function(t){var e=this.tmp,n=t[0],r=t[1],i=t[2];~n&&this.vertices.push(e.vertices[n]),~r&&this.uvs.push(e.uvs[r]),~i&&this.normals.push(e.normals[i])}}]),e}(s["default"]);e["default"]=f},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var u=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),c=n(13),s=n(11),f=r(s),l=n(34),h=r(l),p=n(44),d=r(p),v=function(t){function e(){var t=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],n=t.selector,r=t.name,a=void 0===r?"program":r;i(this,e);var u=o(this,Object.getPrototypeOf(e).call(this,{name:a}));return u.buffer=c.gl.createProgram(),u.vertexShader=new h["default"]({selector:n}),u.fragmentShader=new d["default"]({selector:n}),u.inheritance=["Entity","Program"],u.link(),u}return a(e,t),u(e,[{key:"link",value:function(){var t=this.buffer;c.gl.attachShader(t,this.vertexShader.buffer),c.gl.attachShader(t,this.fragmentShader.buffer),c.gl.linkProgram(t),this.check()}},{key:"bind",value:function(){c.gl.useProgram(this.buffer)}},{key:"check",value:function(){var t=this.buffer,e=c.gl.getProgramParameter(t,c.gl.LINK_STATUS),n=c.gl.isContextLost();if(!e&&!n){var r=c.gl.getProgramInfoLog(t);throw c.gl.deleteProgram(t),new Error(r)}return!0}},{key:"buffer",get:function(){return this._buffer},set:function(t){this._buffer=t}},{key:"vertexShader",get:function(){return this._vertexShader},set:function(t){this._vertexShader=t}},{key:"fragmentShader",get:function(){return this._fragmentShader},set:function(t){this._fragmentShader=t}}]),e}(f["default"]);e["default"]=v},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var u=n(35),c=r(u),s=function(t){function e(){var t=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],n=t.selector,r=t.name,a=void 0===r?"vertex.shader":r;i(this,e);var u=o(this,Object.getPrototypeOf(e).call(this,{name:a,selector:n+'[type="x-shader/x-vertex"]'},"VERTEX_SHADER"));return u.inheritance=["Entity","Shader","VertexShader"],u}return a(e,t),e}(c["default"]);e["default"]=s},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var u=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),c=n(13),s=n(11),f=r(s),l=n(36),h=r(l),p=function(t){function e(){var t=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],n=t.selector,r=t.name,a=void 0===r?"shader":r,u=arguments[1];i(this,e);var s=o(this,Object.getPrototypeOf(e).call(this,{name:a}));return s.buffer=c.gl.createShader(c.gl[u]),s.inheritance=["Entity","Shader"],s.compile(u,n),s}return a(e,t),u(e,[{key:"generate",value:function(t,e){var n=document.querySelector(e).textContent;for(var r in h["default"])n=n.replace("@use "+r+";",h["default"][r][t]);return n}},{key:"compile",value:function(t,e){var n=this.buffer,r=this.generate(t,e);c.gl.shaderSource(n,r),c.gl.compileShader(n),this.check()}},{key:"check",value:function(){var t=this.buffer,e=c.gl.getShaderParameter(t,c.gl.COMPILE_STATUS),n=c.gl.isContextLost();if(!e&&!n){var r=c.gl.getShaderInfoLog(t);throw c.gl.deleteShader(t),new Error(r)}return!0}},{key:"buffer",get:function(){return this._buffer},set:function(t){this._buffer=t}}]),e}(f["default"]);e["default"]=p},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var i=n(37),o=r(i),a=n(38),u=r(a),c=n(39),s=r(c),f=n(40),l=r(f),h=n(41),p=r(h),d=n(42),v=r(d),y=n(43),b=r(y),g={Camera:o["default"],Light:u["default"],DirectionalLight:s["default"],PointLight:l["default"],SpotLight:p["default"],Material:v["default"],ShadowMapper:b["default"]};e["default"]=g},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n="\n   struct Camera\n   {\n      mat4 projectionMatrix;\n      mat4 modelViewMatrix;\n      mat3 normalMatrix;\n   };\n",r="";e["default"]={VERTEX_SHADER:n,FRAGMENT_SHADER:r}},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n="",r="\n   struct Light\n   {\n      vec3 ambient;\n      vec3 diffuse;\n      vec3 specular;\n      float intensity;\n      vec3 location;\n      int type;\n   };\n\n   vec3 Light_main(Light light, Material material, vec4 position, vec3 normal)\n   {\n      vec3 direction = normalize(light.location - position.xyz);\n      float weight = max(dot(direction, normal), 0.0);\n      vec3 ambient = light.ambient * material.ambient;\n      vec3 diffuse = light.intensity * light.diffuse * material.diffuse * weight;\n      vec3 specular = vec3(0.0);\n\n      if (material.type == 1 && weight > 0.0)\n      {\n         specular = light.specular * material.specular * pow(max(dot(reflect(-direction, normal), normalize(-position.xyz)), 0.0), material.shininess);\n      }\n\n      return ambient + diffuse + specular;\n   }\n";e["default"]={VERTEX_SHADER:n,FRAGMENT_SHADER:r}},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n="",r="";e["default"]={VERTEX_SHADER:n,FRAGMENT_SHADER:r}},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n="",r="\n   struct PointLight\n   {\n      vec3 ambient;\n      vec3 diffuse;\n      vec3 specular;\n      float radius;\n      float intensity;\n      vec3 location;\n      int type;\n   };\n\n   vec3 PointLight_main(PointLight light, Material material, vec4 position, vec3 normal)\n   {\n      normal = normalize(normal);\n      vec3 pointToLight = light.location - position.xyz;\n      vec3 direction = normalize(pointToLight);\n      float weight = max(dot(normal, direction), 0.0);\n      vec3 ambient = light.ambient * material.ambient;\n      vec3 diffuse = light.diffuse * material.diffuse * weight;\n      vec3 specular = vec3(0.0);\n      float distanceFromLight = length(pointToLight);\n      float quadratic = pow(distanceFromLight / light.radius + 1.0, 2.0);\n      float attenuation = light.intensity / quadratic;\n\n      if (material.type == 1)\n      {\n         if (weight > 0.0)\n         {\n            vec3 eye = normalize(-position.xyz);\n            vec3 reflection = reflect(-direction, normal);\n            specular = light.specular * material.specular * pow(max(dot(reflection, eye), 0.0), material.shininess);\n         }\n      }\n\n      return ambient + (specular + diffuse) * attenuation;\n   }\n";e["default"]={VERTEX_SHADER:n,FRAGMENT_SHADER:r}},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n="",r="";e["default"]={VERTEX_SHADER:n,FRAGMENT_SHADER:r}},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n="",r="\n   struct Material\n   {\n      int image;\n      vec3 ambient;\n      vec3 diffuse;\n      vec3 specular;\n      float shininess;\n      int shading;\n      int type;\n   };\n\n   uniform sampler2D u_image;\n";e["default"]={VERTEX_SHADER:n,FRAGMENT_SHADER:r}},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n="\n   varying vec4 v_shadow;\n\n   void ShadowMapper_main(vec4 position)\n   {\n      v_shadow = mat4(0.5, 0.0, 0.0, 0.0, 0.0, 0.5, 0.0, 0.0, 0.0, 0.0, 0.5, 0.0, 0.5, 0.5, 0.5, 1.0) * position;\n   }\n",r="\n   struct ShadowMapper\n   {\n      int antialias;\n   };\n\n   uniform ShadowMapper u_shadowMapper;\n   uniform sampler2D u_shadowMap;\n\n   varying vec4 v_shadow;\n\n   float ShadowMapper_step(vec4 nearest)\n   {\n      if (nearest.x >= 0.0 && nearest.x <= 1.0 && nearest.y >= 0.0 && nearest.y <= 1.0)\n      {\n         float shadow = texture2D(u_shadowMap, nearest.xy).r;\n         float biased = nearest.z * 0.99995;\n\n         if (shadow <= biased)\n         {\n            return 0.3;\n         }\n      }\n\n      return 1.0;\n   }\n\n   float ShadowMapper_visibility()\n   {\n      vec4 depth = vec4(v_shadow.xyz / v_shadow.w, v_shadow.w);\n      float result = ShadowMapper_step(depth);\n      float count = 1.0;\n\n      if (u_shadowMapper.antialias == 1)\n      {\n         for (float x = -0.01; x <= 0.01; x += 0.005)\n         {\n            for (float y = -0.01; y <= 0.01; y += 0.005)\n            {\n               vec4 nearest = depth + vec4(x, y, 0.0, 0.0) / depth.w;\n\n               result += ShadowMapper_step(nearest);\n\n               count++;\n            }\n         }\n      }\n\n      return result / count;\n   }\n";e["default"]={VERTEX_SHADER:n,FRAGMENT_SHADER:r}},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var u=n(35),c=r(u),s=function(t){function e(){var t=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],n=t.selector,r=t.name,a=void 0===r?"fragment.shader":r;i(this,e);var u=o(this,Object.getPrototypeOf(e).call(this,{name:a,selector:n+'[type="x-shader/x-fragment"]'},"FRAGMENT_SHADER"));return u.inheritance=["Entity","Shader","FragmentShader"],u}return a(e,t),e}(c["default"]);e["default"]=s},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var u=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),c=n(13),s=n(11),f=r(s),l=function(t){function e(){var t=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],n=t.width,r=t.height,a=t.name,u=void 0===a?"renderbuffer":a;i(this,e);var s=o(this,Object.getPrototypeOf(e).call(this,{name:u}));return s.buffer=c.gl.createRenderbuffer(),s.width=n,s.height=r,s.inheritance=["Entity","Renderbuffer"],s.configure(),s}return a(e,t),u(e,[{key:"configure",value:function(){this.bind(),c.gl.renderbufferStorage(c.gl.RENDERBUFFER,c.gl.DEPTH_COMPONENT16,this.width,this.height),this.unbind()}},{key:"bind",value:function(){c.gl.bindRenderbuffer(c.gl.RENDERBUFFER,this.buffer)}},{key:"unbind",value:function(){c.gl.bindRenderbuffer(c.gl.RENDERBUFFER,null)}},{key:"buffer",get:function(){return this._buffer},set:function(t){this._buffer=t}},{key:"width",get:function(){return this._width},set:function(t){this._width=t}},{key:"height",get:function(){return this._height},set:function(t){this._height=t}}]),e}(f["default"]);e["default"]=l},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var u=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),c=n(1),s=n(11),f=r(s),l=function(t){function e(){var t=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],n=t.name,r=void 0===n?"scene":n;i(this,e);var a=o(this,Object.getPrototypeOf(e).call(this,{
name:r}));return a.program=void 0,a.meshes=[],a.simulations=[],a.lights=[],a.scale=c.vec3.fromValues(1,1,1),a.rotation=0,a.translation=c.vec3.fromValues(0,0,0),a.inheritance=["Entity","Scene"],a}return a(e,t),u(e,[{key:"use",value:function(t){t.bind(),this.program=t}},{key:"put",value:function(t){switch(!0){case t.isType("Mesh"):this.meshes.push(t);break;case t.isType("ParticleSystem"):this.simulations.push(t),this.meshes.push(t.mesh);break;case t.isType("Light"):this.lights.push(t);break;default:console.warn(t.name+" disallowed in scene")}}},{key:"animate",value:function(t,e){var n=arguments.length<=2||void 0===arguments[2]?!1:arguments[2],r=arguments.length<=3||void 0===arguments[3]?!1:arguments[3],i=this.animate.bind(this,t,e,n,r);this.render.apply(this,arguments),requestAnimationFrame(i)}},{key:"render",value:function(t,e){var n=arguments.length<=2||void 0===arguments[2]?!1:arguments[2],r=arguments.length<=3||void 0===arguments[3]?!1:arguments[3],i=this.program;t.bind(),n&&n(),e.save(),e.scale.apply(e,this.scale),e.rotate(this.rotation),e.translate.apply(e,this.translation),this.lights.forEach(function(t){return t.bind(i)}),this.simulations.forEach(function(t){return t.solve()}),this.meshes.forEach(this.draw.bind(this,e)),e.restore(),r&&r(),t.unbind()}},{key:"draw",value:function(t,e){var n=this.program,r=e.material;t.save(),t.scale.apply(t,e.scale),t.rotate(e.rotation),t.translate.apply(t,e.translation),t.bind(n),r.bind(n),e.draw({program:n}),r.unbind(),t.restore()}},{key:"program",get:function(){return this._program},set:function(t){this._program=t}},{key:"meshes",get:function(){return this._meshes},set:function(t){this._meshes=t}},{key:"lights",get:function(){return this._lights},set:function(t){this._lights=t}},{key:"scale",get:function(){return this._scale},set:function(t){this._scale=t}},{key:"rotation",get:function(){return this._rotation},set:function(t){this._rotation=t}},{key:"translation",get:function(){return this._translation},set:function(t){this._translation=t}}]),e}(f["default"]);e["default"]=l},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var u=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),c=function g(t,e,n){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,e);if(void 0===r){var i=Object.getPrototypeOf(t);return null===i?void 0:g(i,e,n)}if("value"in r)return r.value;var o=r.get;if(void 0!==o)return o.call(n)},s=(n(13),n(16)),f=r(s),l=n(48),h=r(l),p=n(50),d=r(p),v=n(22),y=r(v),b=function(t){function e(){var t=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],n=t.width,r=t.height,a=t.name,u=void 0===a?"shadow.mapper":a,c=t.path,s=void 0===c?"shadowMapper":c,f=t.uniforms,l=void 0===f?["i antialias","sampler shadowMap"]:f,p=t.antialias,v=void 0===p?!1:p;i(this,e);var b=o(this,Object.getPrototypeOf(e).call(this,{name:u,path:s,uniforms:l}));return b.colorAttachment=new h["default"]({width:n,height:r}),b.depthAttachment=new d["default"]({width:n,height:r}),b.view=new y["default"]({colorAttachment:b.colorAttachment,depthAttachment:b.depthAttachment}),b.shadowMap=b.depthAttachment.unit,b.antialias=v,b.inheritance=["Entity","Structure","ShadowMapper"],b}return a(e,t),u(e,[{key:"bind",value:function(t){c(Object.getPrototypeOf(e.prototype),"bind",this).call(this,t),this.depthAttachment.bind()}},{key:"unbind",value:function(){this.depthAttachment.unbind()}},{key:"colorAttachment",get:function(){return this._colorAttachment},set:function(t){this._colorAttachment=t}},{key:"depthAttachment",get:function(){return this._depthAttachment},set:function(t){this._depthAttachment=t}},{key:"view",get:function(){return this._view},set:function(t){this._view=t}},{key:"shadowMap",get:function(){return this._shadowMap},set:function(t){this._shadowMap=t}},{key:"antialias",get:function(){return this._antialias},set:function(t){this._antialias=t}}]),e}(f["default"]);e["default"]=b},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var u=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),c=function p(t,e,n){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,e);if(void 0===r){var i=Object.getPrototypeOf(t);return null===i?void 0:p(i,e,n)}if("value"in r)return r.value;var o=r.get;if(void 0!==o)return o.call(n)},s=(n(1),n(13)),f=n(49),l=r(f),h=function(t){function e(){var t=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],n=t.width,r=t.height,a=t.lod,u=t.components,c=t.format,s=t.magnification,f=t.minification,l=t.S,h=t.T,p=t.name,d=void 0===p?"data.texture":p,v=t.image,y=void 0===v?null:v;i(this,e);var b=o(this,Object.getPrototypeOf(e).call(this,{name:d,lod:a,components:u,format:c,magnification:s,minification:f,S:l,T:h}));return b.image=y,b.width=n,b.height=r,b.inheritance=["Entity","Texture","DataTexture"],b.autofill(),b.configure(),b}return a(e,t),u(e,[{key:"configure",value:function(){c(Object.getPrototypeOf(e.prototype),"configure",this).call(this);var t=this.components,n=this.image;n instanceof Array&&(s.gl.pixelStorei(s.gl.PACK_ALIGNMENT,1),s.gl.pixelStorei(s.gl.UNPACK_ALIGNMENT,1),s.gl.getExtension("OES_texture_float"),n=new Float32Array(n)),s.gl.texImage2D(s.gl.TEXTURE_2D,this.lod,t,this.width,this.height,0,t,this.format,n),this.unbind()}},{key:"autofill",value:function(){var t=this.image;if(t instanceof Array){var e=this.width*this.height*this.length-t.length,n=Array.from({length:e},function(){return-1});this.image=t.concat(n)}}},{key:"image",get:function(){return this._image},set:function(t){this._image=t}},{key:"width",get:function(){return this._width},set:function(t){this._width=t}},{key:"height",get:function(){return this._height},set:function(t){this._height=t}}]),e}(l["default"]);e["default"]=h},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var u=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),c=n(13),s=n(11),f=r(s),l=0,h=function(t){function e(){var t=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],n=t.name,r=void 0===n?"texture":n,a=t.lod,u=void 0===a?0:a,s=t.components,f=void 0===s?"RGBA":s,h=t.format,p=void 0===h?"UNSIGNED_BYTE":h,d=t.magnification,v=void 0===d?"NEAREST":d,y=t.minification,b=void 0===y?"NEAREST":y,g=t.S,m=void 0===g?"CLAMP_TO_EDGE":g,_=t.T,w=void 0===_?"CLAMP_TO_EDGE":_;i(this,e);var O=o(this,Object.getPrototypeOf(e).call(this,{name:r}));return O.buffer=c.gl.createTexture(),O.lod=u,O.components=f,O.length=f.length,O.format=p,O.magnification=v,O.minification=b,O.S=m,O.T=w,O.unit=l++,O.inheritance=["Entity","Texture"],O}return a(e,t),u(e,[{key:"configure",value:function(){this.bind(),c.gl.texParameteri(c.gl.TEXTURE_2D,c.gl.TEXTURE_MAG_FILTER,this.magnification),c.gl.texParameteri(c.gl.TEXTURE_2D,c.gl.TEXTURE_MIN_FILTER,this.minification),c.gl.texParameteri(c.gl.TEXTURE_2D,c.gl.TEXTURE_WRAP_S,this.S),c.gl.texParameteri(c.gl.TEXTURE_2D,c.gl.TEXTURE_WRAP_T,this.T)}},{key:"bind",value:function(){var t=c.gl.TEXTURE0+this.unit;c.gl.activeTexture(t),c.gl.bindTexture(c.gl.TEXTURE_2D,this.buffer)}},{key:"unbind",value:function(){c.gl.bindTexture(c.gl.TEXTURE_2D,null)}},{key:"buffer",get:function(){return this._buffer},set:function(t){this._buffer=t}},{key:"lod",get:function(){return this._lod},set:function(t){this._lod=t}},{key:"components",get:function(){return this._components},set:function(t){this._components=c.gl[t]}},{key:"length",get:function(){return this._length},set:function(t){this._length=t}},{key:"format",get:function(){return this._format},set:function(t){this._format=c.gl[t]}},{key:"magnification",get:function(){return this._magnification},set:function(t){this._magnification=c.gl[t]}},{key:"minification",get:function(){return this._minification},set:function(t){this._minification=c.gl[t]}},{key:"S",get:function(){return this._S},set:function(t){this._S=c.gl[t]}},{key:"T",get:function(){return this._T},set:function(t){this._T=c.gl[t]}},{key:"unit",get:function(){return this._unit},set:function(t){this._unit=t}}]),e}(f["default"]);e["default"]=h},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var u=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),c=function p(t,e,n){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,e);if(void 0===r){var i=Object.getPrototypeOf(t);return null===i?void 0:p(i,e,n)}if("value"in r)return r.value;var o=r.get;if(void 0!==o)return o.call(n)},s=n(13),f=n(49),l=r(f),h=function(t){function e(){var t=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],n=t.width,r=t.height,a=t.name,u=void 0===a?"depth.texture":a;i(this,e);var c=o(this,Object.getPrototypeOf(e).call(this,{name:u}));return c.buffer=s.gl.createTexture(),c.width=n,c.height=r,c.inheritance=["Entity","Texture","DepthTexture"],c.configure(),c}return a(e,t),u(e,[{key:"configure",value:function(){c(Object.getPrototypeOf(e.prototype),"configure",this).call(this),s.gl.getExtension("WEBGL_depth_texture"),s.gl.texImage2D(s.gl.TEXTURE_2D,0,s.gl.DEPTH_COMPONENT,this.width,this.height,0,s.gl.DEPTH_COMPONENT,s.gl.UNSIGNED_INT,null),this.unbind()}},{key:"buffer",get:function(){return this._buffer},set:function(t){this._buffer=t}},{key:"width",get:function(){return this._width},set:function(t){this._width=t}},{key:"height",get:function(){return this._height},set:function(t){this._height=t}}]),e}(l["default"]);e["default"]=h},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var u=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),c=function v(t,e,n){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,e);if(void 0===r){var i=Object.getPrototypeOf(t);return null===i?void 0:v(i,e,n)}if("value"in r)return r.value;var o=r.get;if(void 0!==o)return o.call(n)},s=n(13),f=n(52),l=r(f),h=n(49),p=r(h),d=function(t){function e(){var t=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],n=t.path,r=t.lod,a=t.components,u=t.format,c=t.magnification,f=t.minification,l=t.S,h=t.T,p=t.name,d=void 0===p?"image.texture":p,v=t.anisotropy,y=void 0===v?!1:v,b=t.mipmap,g=void 0===b?!1:b;i(this,e);var m=o(this,Object.getPrototypeOf(e).call(this,{name:d,lod:r,components:a,format:u,magnification:c,minification:f,S:l,T:h}));return m.image=void 0,m.promise=m.fetch(n),m.anisotropicFilter=s.gl.getExtension("EXT_texture_filter_anisotropic"),m.anisotropy=y,m.mipmap=g,m.inheritance=["Entity","Texture","ImageTexture"],m}return a(e,t),u(e,[{key:"fetch",value:function(t){return(0,l["default"])(t).then(this.define.bind(this)).then(this.configure.bind(this))}},{key:"define",value:function(t){this.image=t}},{key:"configure",value:function(){c(Object.getPrototypeOf(e.prototype),"configure",this).call(this);var t=this.components,n=this.anisotropy;s.gl.pixelStorei(s.gl.UNPACK_FLIP_Y_WEBGL,!0),n&&s.gl.texParameterf(s.gl.TEXTURE_2D,this.anisotropicFilter.TEXTURE_MAX_ANISOTROPY_EXT,n),s.gl.texImage2D(s.gl.TEXTURE_2D,this.lod,t,t,this.format,this.image),this.mipmap&&s.gl.generateMipmap(s.gl.TEXTURE_2D),this.unbind()}},{key:"image",get:function(){return this._image},set:function(t){this._image=t}},{key:"anisotropicFilter",get:function(){return this._anisotropicFilter},set:function(t){this._anisotropicFilter=t}},{key:"anisotropy",get:function(){return this._anisotropy},set:function(t){var e=this.anisotropicFilter;if(e&&t!==!1){var n=s.gl.getParameter(e.MAX_TEXTURE_MAX_ANISOTROPY_EXT);t=Math.min(t,Math.max(t,n))}else t=0;this._anisotropy=t}},{key:"mipmap",get:function(){return this._mipmap},set:function(t){this._mipmap=t}}]),e}(p["default"]);e["default"]=d},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function i(t){return(0,a["default"])(function(e,n){var r=new Image;r.src=t,r.onload=function(t){e(r,t)},r.onerror=function(t){n(t)}})}Object.defineProperty(e,"__esModule",{value:!0});var o=n(31),a=r(o);e["default"]=i},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var u=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),c=n(1),s=n(11),f=r(s),l=function(t){function e(){var t=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],n=t.name,r=void 0===n?"particle":n,a=t.mass,u=void 0===a?1:a,s=t.damping,f=void 0===s?0:s,l=t.acceleration,h=void 0===l?c.vec3.fromValues(0,0,0):l,p=t.velocity,d=void 0===p?c.vec3.fromValues(0,0,0):p,v=t.position,y=void 0===v?c.vec3.fromValues(0,0,0):v,b=t.normal,g=void 0===b?c.vec3.fromValues(0,0,0):b,m=t.frozen,_=void 0===m?!1:m;i(this,e);var w=o(this,Object.getPrototypeOf(e).call(this,{name:r}));return w.mass=u,w.damping=f,w.acceleration=h,w.velocity=d,w.previous=c.vec3.clone(y),w.position=y,w.normal=g,w.frozen=_,w.inheritance=["Entity","Particle"],w}return a(e,t),u(e,[{key:"exert",value:function(t){var e=c.vec3.scale(c.vec3.create(),t,1/this.mass);this.accelerate(e)}},{key:"accelerate",value:function(t){c.vec3.add(this.acceleration,this.acceleration,t)}},{key:"dampen",value:function(t){c.vec3.scale(this.velocity,this.velocity,t)}},{key:"euler",value:function(t){if(!this.frozen){var e=c.vec3.clone(this.velocity);c.vec3.add(this.velocity,this.velocity,c.vec3.scale(c.vec3.create(),this.acceleration,t)),c.vec3.add(this.position,this.position,c.vec3.scale(c.vec3.create(),e,t))}}},{key:"simplectic",value:function(t){this.frozen||(c.vec3.add(this.velocity,this.velocity,c.vec3.scale(c.vec3.create(),this.acceleration,t)),c.vec3.add(this.position,this.position,c.vec3.scale(c.vec3.create(),this.velocity,t)))}},{key:"verlet",value:function(t){if(!this.frozen){var e=c.vec3.clone(this.previous),n=c.vec3.clone(this.position);c.vec3.add(this.position,c.vec3.add(c.vec3.create(),n,c.vec3.sub(c.vec3.create(),n,e)),c.vec3.scale(c.vec3.create(),this.acceleration,Math.pow(t,2))),c.vec3.copy(this.previous,n),c.vec3.scale(this.velocity,c.vec3.sub(c.vec3.create(),this.position,this.previous),1/t)}}},{key:"freeze",value:function(){this.frozen=!0}},{key:"unfreeze",value:function(){this.frozen=!1}},{key:"mass",get:function(){return this._mass},set:function(t){this._mass=t}},{key:"damping",get:function(){return this._damping},set:function(t){this._damping=t}},{key:"acceleration",get:function(){return this._acceleration},set:function(t){this._acceleration=t}},{key:"velocity",get:function(){return this._velocity},set:function(t){this._velocity=t}},{key:"previous",get:function(){return this._previous},set:function(t){this._previous=t}},{key:"position",get:function(){return this._position},set:function(t){this._position=t}},{key:"normal",get:function(){return this._normal},set:function(t){this._normal=t}},{key:"frozen",get:function(){return this._frozen},set:function(t){this._frozen=t}}]),e}(f["default"]);e["default"]=l},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var u=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),c=n(1),s=n(11),f=r(s),l=n(53),h=r(l),p=function(t){function e(){var t=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],n=t.mesh,r=t.name,a=void 0===r?"particle.system":r,u=t.gravity,s=void 0===u?c.vec3.fromValues(0,-9.80665,0):u,f=t.timestep,l=void 0===f?.003:f,p=t.solver,d=void 0===p?"VERLET":p,v=t.paused,y=void 0===v?!1:v;i(this,e);var b=o(this,Object.getPrototypeOf(e).call(this,{name:a}));return b.mesh=n,b.particles=n.vertices.map(function(t){return new h["default"]({position:t})}),b.gravity=s,b.timestep=l,b.solver=d,b.paused=y,b.inheritance=["Entity","ParticleSystem"],b}return a(e,t),u(e,[{key:"solve",value:function(){this.paused||(this.particles.forEach(this.integrate.bind(this)),this.mesh.update(this.vertices()))}},{key:"integrate",value:function(t){t.accelerate(this.gravity),t[this.solver](this.timestep)}},{key:"vertices",value:function(){var t=this.particles,e=[];return t.forEach(function(t){return e.push(t.position)}),e}},{key:"stop",value:function(){this.paused=!0}},{key:"run",value:function(){this.paused=!1}},{key:"mesh",get:function(){return this._mesh},set:function(t){this._mesh=t}},{key:"particles",get:function(){return this._particles},set:function(t){this._particles=t}},{key:"gravity",get:function(){return this._gravity},set:function(t){this._gravity=t}},{key:"timestep",get:function(){return this._timestep},set:function(t){this._timestep=t}},{key:"solver",get:function(){return this._solver.toLowerCase()},set:function(t){this._solver=t}},{key:"paused",get:function(){return this._paused},set:function(t){this._paused=t}}]),e}(f["default"]);e["default"]=p},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var u=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),c=n(1),s=n(11),f=r(s),l={STRUCTURAL:100,SHEAR:10,BEND:1},h=function(t){function e(){var t=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],n=t.i,r=t.j,a=t.stiffness,u=t.damping,s=t.name,f=void 0===s?"spring":s,l=t.type,h=void 0===l?"STRUCTURAL":l;i(this,e);var p=o(this,Object.getPrototypeOf(e).call(this,{name:f}));return p.i=n,p.j=r,p.length=c.vec3.distance(n.position,r.position),p.type=h,p.stiffness=a,p.damping=u,p.inheritance=["Entity","Spring"],p}return a(e,t),u(e,[{key:"spread",value:function(t){return t*(l[this.type]/100)}},{key:"relax",value:function(){var t=this.i,e=this.j,n=c.vec3.sub(c.vec3.create(),t.position,e.position),r=c.vec3.length(n),i=c.vec3.normalize(c.vec3.create(),n),o=c.vec3.sub(c.vec3.create(),t.velocity,e.velocity),a=this.stiffness*(r-this.length),u=this.damping*c.vec3.dot(o,i),s=c.vec3.scale(c.vec3.create(),i,a+u);t.exert(c.vec3.negate(c.vec3.create(),s)),e.exert(s)}},{key:"i",get:function(){return this._i},set:function(t){this._i=t}},{key:"j",get:function(){return this._j},set:function(t){this._j=t}},{key:"length",get:function(){return this._length},set:function(t){this._length=t}},{key:"type",get:function(){return this._type},set:function(t){this._type=t}},{key:"stiffness",get:function(){return this._stiffness},set:function(t){this._stiffness=this.spread(t)}},{key:"damping",get:function(){return this._damping},set:function(t){this._damping=this.spread(t)}}]),e}(f["default"]);e["default"]=h},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function i(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function u(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var c=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),s=function v(t,e,n){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,e);if(void 0===r){var i=Object.getPrototypeOf(t);return null===i?void 0:v(i,e,n)}if("value"in r)return r.value;var o=r.get;if(void 0!==o)return o.call(n)},f=n(54),l=r(f),h=n(55),p=r(h),d=function(t){function e(){var t=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],n=t.mesh,r=t.gravity,i=t.timestep,u=t.solver,c=t.paused,s=t.name,f=void 0===s?"cloth":s,l=t.stiffness,h=void 0===l?0:l,p=t.damping,d=void 0===p?0:p;o(this,e);var v=a(this,Object.getPrototypeOf(e).call(this,{name:f,mesh:n,gravity:r,timestep:i,solver:u,paused:c}));return v.stiffness=h,v.damping=d,v.springs=[],v.inheritance=["Entity","ParticleSystem","Cloth"],v.model(),v}return u(e,t),c(e,[{key:"model",value:function(){for(var t=this.mesh.indices,e=[],n=3,r=0,i=t.length;i>r;r+=n){var o=t.slice(r,r+n);e.push(o)}this.particles.forEach(this.find.bind(this,e))}},{key:"find",value:function(t,e,n){var r=[];t.forEach(this.thread.bind(this,r,n))}},{key:"thread",value:function(t,e,n){if(~n.indexOf(e)){var r,o=n.filter(function(n){return n!==e&&!~t.indexOf(n)}),a=o.map(this.stitch.bind(this,e));(r=this.springs).push.apply(r,i(a)),t.push.apply(t,i(o))}}},{key:"stitch",value:function(t,e,n){var r=this.particles,i=n%2?"STRUCTURAL":"SHEAR";return new p["default"]({i:r[t],j:r[e],stiffness:this.stiffness,damping:this.damping,type:i})}},{key:"solve",value:function(){this.paused||(this.springs.forEach(function(t){return t.relax()}),s(Object.getPrototypeOf(e.prototype),"solve",this).call(this))}},{key:"stiffness",get:function(){return this._stiffness},set:function(t){this._stiffness=t}},{key:"damping",get:function(){return this._damping},set:function(t){this._damping=t}},{key:"springs",get:function(){return this._springs},set:function(t){this._springs=t}}]),e}(l["default"]);e["default"]=d},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var u=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),c=n(11),s=r(c),f=n(31),l=r(f),h=function(t){function e(){var t=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],n=t.name,r=void 0===n?"bundle":n,a=t.items,u=void 0===a?[]:a,c=t.step,s=void 0===c?function(){}:c;i(this,e);var f=o(this,Object.getPrototypeOf(e).call(this,{name:r}));return f.promises=u,f.size=u.length,f.progress=u.length,f.step=s,f.inheritance=["Entity","Bundle"],f}return a(e,t),u(e,[{key:"next",value:function(){var t=--this.progress,e=100-t/this.size*100;this.step(e)}},{key:"sync",value:function(t){this.promises.push(t.promise)}},{key:"ready",value:function(t){return this.promise=(0,l["default"])().all(this.promises).then(function(){t()})}},{key:"promises",get:function(){return this._promises},set:function(t){var e=this;this._promises=Object.keys(t).map(function(n){return t[n].promise.then(e.next.bind(e))})}},{key:"size",get:function(){return this._size},set:function(t){this._size=t}},{key:"progress",get:function(){return this._progress},set:function(t){this._progress=t}},{key:"step",get:function(){return this._step},set:function(t){this._step=t}}]),e}(s["default"]);e["default"]=h}]);